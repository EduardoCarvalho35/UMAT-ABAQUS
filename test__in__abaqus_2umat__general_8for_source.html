<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>UMAT-ABAQUS: test_in_abaqus/umat_general.for Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UMAT-ABAQUS
   </div>
   <div id="projectbrief">A general framework to develop material models (UMAT) in ABAQUS</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0e8ad12f1a177d35f18d248de5a55e76.html">test_in_abaqus</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">umat_general.for</div>  </div>
</div><!--header-->
<div class="contents">
<a href="test__in__abaqus_2umat__general_8for.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="pull2_8for.html#adb120bb864e22163bbc3bff6f3abeba8">pull2</a>(PK,SIG,FINV,DET,NDI)</div><div class="line"><a name="l00002"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#adb120bb864e22163bbc3bff6f3abeba8">    2</a></span>&#160;<span class="comment">C&gt;       PULL-BACK TIMES DET OF A 2ND ORDER TENSOR</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;       <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;       include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;       <span class="keywordtype">INTEGER</span> I1,J1,II1,JJ1,NDI</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> PK(ndi,ndi),FINV(ndi,ndi)</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> SIG(ndi,ndi)</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> AUX,DET</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;       <span class="keywordflow">DO</span> i1=1,ndi</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        <span class="keywordflow">DO</span> j1=1,ndi</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;          aux=zero</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;         <span class="keywordflow">DO</span> ii1=1,ndi</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;          <span class="keywordflow">DO</span> jj1=1,ndi</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;            aux=aux+det*finv(i1,ii1)*finv(j1,jj1)*sig(ii1,jj1)</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keywordflow">         END DO</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;           pk(i1,j1)=aux</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keywordflow">       END DO</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;       <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="pull2_8for.html#adb120bb864e22163bbc3bff6f3abeba8">pull2</a></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="pinvariants_8for.html#aaaa7b07924c642fe785a9a8dc96e885e">pinvariants</a>(A,INV4,NDI,ST,LAMBDA,BARLAMBDA,DET)</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#aaaa7b07924c642fe785a9a8dc96e885e">   26</a></span>&#160;<span class="comment">C&gt;    AND 4TH PSEUDO-INVARIANTS OF A TENSOR</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      <span class="keywordtype">INTEGER</span> NDI,I,J</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> A(ndi,ndi),DET,SCALE1,ST(ndi,ndi),LAMBDA</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> BARLAMBDA,INV4</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        inv4=zero</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      <span class="keywordflow">DO</span> i=1,ndi</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <span class="keywordflow">DO</span> j=1, ndi</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            inv4=inv4+a(i,j)*st(i,j)</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keywordflow">        ENDDO</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keywordflow">      ENDDO</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">C     STRETCH</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      scale1=det**(-one /three)</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      barlambda=dsqrt(inv4)</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      lambda=barlambda/scale1</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="pinvariants_8for.html#aaaa7b07924c642fe785a9a8dc96e885e">pinvariants</a></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="metvol_8for.html#af4851b40ff9da9c702d8d02257ee2d41">metvol</a>(CVOL,C,PV,PPV,DET,NDI)</div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#af4851b40ff9da9c702d8d02257ee2d41">   48</a></span>&#160;<span class="comment">C&gt;    VOLUMETRIC MATERIAL ELASTICITY TENSOR</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordtype">INTEGER</span> NDI,I1,J1,K1,L1</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> C(ndi,ndi),CINV(ndi,ndi),</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;     1                 cvol(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> PV,PPV,DET</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keyword">CALL </span><a class="code" href="minverse3d_8for.html#a57fcae0e55c917727e5a5e824f445f4e">matinv3d</a>(c,cinv,ndi)</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordflow">DO</span> i1 = 1, ndi</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordflow">DO</span> j1 = 1, ndi</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;         <span class="keywordflow">DO</span> k1 = 1, ndi</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;           <span class="keywordflow">DO</span> l1 = 1, ndi</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;             cvol(i1,j1,k1,l1)=</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;     1                 det*ppv*cinv(i1,j1)*cinv(k1,l1)</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;     2           -det*pv*(cinv(i1,k1)*cinv(j1,l1)</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;     3                      +cinv(i1,l1)*cinv(j1,k1))</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keywordflow">           END DO</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="keywordflow">         END DO</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="metvol_8for.html#af4851b40ff9da9c702d8d02257ee2d41">metvol</a></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="contraction42_8for.html#aad71a324137b3d597992a6ba4386bc1c">contraction42</a>(S,LT,RT,NDI)</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#aad71a324137b3d597992a6ba4386bc1c">   75</a></span>&#160;<span class="comment">C&gt;       DOUBLE CONTRACTION BETWEEN 4TH ORDER AND 2ND ORDER  TENSOR</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">C&gt;      INPUT:</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">C&gt;       LT - RIGHT 4TH ORDER TENSOR</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">C&gt;       RT - LEFT  2ND ODER TENSOR</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">C&gt;      OUTPUT:</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">C&gt;       S - DOUBLE CONTRACTED TENSOR (2ND ORDER)</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;       <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;       include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;       <span class="keywordtype">INTEGER</span> I1,J1,K1,L1,NDI</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> RT(ndi,ndi),LT(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> S(ndi,ndi)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> AUX</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;       <span class="keywordflow">DO</span> i1=1,ndi</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keywordflow">DO</span> j1=1,ndi</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;          aux=zero</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;         <span class="keywordflow">DO</span> k1=1,ndi</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;          <span class="keywordflow">DO</span> l1=1,ndi</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            aux=aux+lt(i1,j1,k1,l1)*rt(k1,l1)</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="keywordflow">         END DO</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;           s(i1,j1)=aux</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keywordflow">       END DO</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;       <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="contraction42_8for.html#aad71a324137b3d597992a6ba4386bc1c">contraction42</a></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">C&gt;********************************************************************</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">C&gt; Record of revisions:                                              |</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">C&gt;        Date        Programmer        Description of change        |</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">C&gt;        ====        ==========        =====================        |</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">C&gt;     15/11/2017    Joao Ferreira      cont mech general eqs        |</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">C&gt;     01/11/2018    Joao Ferreira      comments added               |</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">C&gt;--------------------------------------------------------------------</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">C&gt;     Description:</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">C&gt;     UMAT: IMPLEMENTATION OF THE CONSTITUTIVE EQUATIONS BASED UPON </span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">C&gt;     A STRAIN-ENERGY FUNCTION (SEF).</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">C&gt;     THIS CODE, AS IS, EXPECTS A SEF BASED ON THE INVARIANTS OF THE </span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">C&gt;     CAUCHY-GREEN TENSORS. A VISCOELASTIC COMPONENT IS ALSO </span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">C&gt;     INCLUDED IF NEEDED. </span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">C&gt;     YOU CAN CHOOSE TO COMPUTE AT THE MATERIAL FRAME AND THEN </span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">C&gt;     PUSHFORWARD OR  COPUTE AND THE SPATIAL FRAME DIRECTLY.</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">C&gt;--------------------------------------------------------------------</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">C&gt;     IF YOU WANT TO ADAPT THE CODE ACCORDING TO YOUR SEF:</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">C&gt;    ISOMAT - DERIVATIVES OF THE SEF IN ORDER TO THE INVARIANTS</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">C&gt;    ADD OTHER CONTRIBUTIONS: STRESS AND TANGENT MATRIX</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">C&gt;-------------------------------------------------------------------- </span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">C      STATE VARIABLES: CHECK ROUTINES - INITIALIZE, WRITESDV, READSDV.</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">C&gt;--------------------------------------------------------------------              </span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">C&gt;     UEXTERNALDB: READ FILAMENTS ORIENTATION AND PREFERED DIRECTION</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">C&gt;--------------------------------------------------------------------</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">C&gt;---------------------------------------------------------------------</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="__umat_8for.html#ade59a72c9e55c27de31535430ff6916e">umat</a>(STRESS,STATEV,DDSDDE,SSE,SPD,SCD,</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;     1 rpl,ddsddt,drplde,drpldt,</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;     2 stran,dstran,time,dtime,temp,dtemp,predef,dpred,cmname,</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;     3 ndi,nshr,ntens,nstatev,props,nprops,coords,drot,pnewdt,</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;     4 celent,dfgrd0,dfgrd1,noel,npt,layer,kspt,kstep,kinc)</div><div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#ade59a72c9e55c27de31535430ff6916e">  133</a></span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">C--------------------------- DECLARATIONS -----------------------------</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">C     ADD COMMON BLOCKS HERE IF NEEDED (and in uexternal)</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">C      COMMON /KBLOCK/KBLOCK</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="keyword">COMMON</span> /kfib/fibori</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordtype">CHARACTER*8</span> CMNAME</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordtype">INTEGER</span> NDI, NSHR, NTENS, NSTATEV, NPROPS, NOEL, NPT,</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;     1        layer, kspt, kstep, kinc</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">C     </span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> STRESS(ntens),STATEV(nstatev),</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;     1 ddsdde(ntens,ntens),ddsddt(ntens),drplde(ntens),</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;     2 stran(ntens),dstran(ntens),time(2),predef(1),dpred(1),</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;     3 props(nprops),coords(3),drot(3,3),dfgrd0(3,3),dfgrd1(3,3),</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;     4 fibori(nelem,4)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> SSE, SPD, SCD, RPL, DRPLDT, DTIME, TEMP,</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;     1                 dtemp,pnewdt,celent</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="keywordtype">INTEGER</span> NTERM</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">C     FLAGS</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">C      INTEGER FLAG1</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">C     UTILITY TENSORS</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> UNIT2(ndi,ndi),UNIT4(ndi,ndi,ndi,ndi),</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;     1                 unit4s(ndi,ndi,ndi,ndi),</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;     2                 proje(ndi,ndi,ndi,ndi),projl(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">C     KINEMATICS</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> DISTGR(ndi,ndi),C(ndi,ndi),B(ndi,ndi),</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;     1                 cbar(ndi,ndi),bbar(ndi,ndi),distgrinv(ndi,ndi),</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;     2                 ubar(ndi,ndi),vbar(ndi,ndi),rot(ndi,ndi),</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;     3                 dfgrd1inv(ndi,ndi)</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> DET,CBARI1,CBARI2</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">C     VOLUMETRIC CONTRIBUTION</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> PKVOL(ndi,ndi),SVOL(ndi,ndi),</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;     1                 cvol(ndi,ndi,ndi,ndi),cmvol(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> KBULK,PV,PPV,SSEV</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">C     ISOCHORIC CONTRIBUTION</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> SISO(ndi,ndi),PKISO(ndi,ndi),PK2(ndi,ndi),</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;     1                 ciso(ndi,ndi,ndi,ndi),cmiso(ndi,ndi,ndi,ndi),</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;     2                 sfic(ndi,ndi),cfic(ndi,ndi,ndi,ndi),</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;     3                 pkfic(ndi,ndi),cmfic(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">C     ISOCHORIC ISOTROPIC CONTRIBUTION</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> C10,C01,SSEISO,DISO(5),PKMATFIC(ndi,ndi),</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;     1                 smatfic(ndi,ndi),sisomatfic(ndi,ndi),</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;     2                 cmisomatfic(ndi,ndi,ndi,ndi),</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;     3                 cisomatfic(ndi,ndi,ndi,ndi)   </div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">C     ISOCHORIC ANISOTROPIC CONTRIBUTION</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> K1,K2,KDISP,SSEANISO,</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;     1                 daniso(4),</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;     2                 pkmatficaniso(ndi,ndi),</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;     3                 sanisomatfic(ndi,ndi),</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;     4                 cmanisomatfic(ndi,ndi,ndi,ndi),</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;     6                 canisomatfic(ndi,ndi,ndi,ndi),</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;     8                 lambda,barlambda,</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;     9                 cbari4</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> VORIF(3),VD(3),M0(3,3),MM(3,3),</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;     1        vorif2(3),vd2(3),n0(3,3),nn(3,3)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">C     LIST VARS OF OTHER CONTRIBUTIONS HERE</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">C     VISCOUS PROPERTIES (GENERALIZED MAXWEL DASHPOTS)</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> VSCPROPS(6)</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordtype">INTEGER</span> VV</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">C     JAUMMAN RATE CONTRIBUTION (REQUIRED FOR ABAQUS UMAT)</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> CJR(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">C     CAUCHY STRESS AND ELASTICITY TENSOR</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> SIGMA(ndi,ndi),DDSIGDDE(ndi,ndi,ndi,ndi),</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;     1                                 ddpkdde(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">C     TESTING/DEBUG VARS</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> STEST(ndi,ndi), CTEST(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">C-------------------------- INITIALIZATIONS ---------------------------</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">C     IDENTITY AND PROJECTION TENSORS</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      unit2=zero</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      unit4=zero</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      unit4s=zero</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      proje=zero</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      projl=zero</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">C     KINEMATICS</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      distgr=zero</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      c=zero</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      b=zero</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      cbar=zero</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      bbar=zero</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      ubar=zero</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      vbar=zero</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      rot=zero</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      det=zero</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      cbari1=zero</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      cbari2=zero</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">C     VOLUMETRIC</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      pkvol=zero</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      svol=zero</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      cvol=zero</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      kbulk=zero</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      pv=zero</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      ppv=zero</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      ssev=zero</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">C     ISOCHORIC</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      siso=zero</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      pkiso=zero</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      pk2=zero</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      ciso=zero</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      cfic=zero</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      sfic=zero</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      pkfic=zero</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">C     ISOTROPIC</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      c10=zero</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      c01=zero</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      sseiso=zero</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      diso=zero</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      pkmatfic=zero</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      smatfic=zero</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      sisomatfic=zero</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      cmisomatfic=zero</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      cisomatfic=zero</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">C     INITIALIZE OTHER CONT HERE</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">C     JAUMANN RATE</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      cjr=zero</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">C     TOTAL CAUCHY STRESS AND ELASTICITY TENSORS</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      sigma=zero</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      ddsigdde=zero</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">C------------------------ IDENTITY TENSORS ----------------------------</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <span class="keyword">CALL </span><a class="code" href="identity__tensors_8for.html#a03fd2442d72065c8a2c3cfb10467ceb6">onem</a>(unit2,unit4,unit4s,ndi)</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">C------------------- MATERIAL CONSTANTS AND DATA ----------------------</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">C     VOLUMETRIC</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      kbulk    = props(1)</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">C     ISOCHORIC ISOTROPIC NEO HOOKE</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      c10      = props(2)</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      c01      = props(3)    </div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">C     ISOCHORIC ANISOTROPIC GHO</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      k1      = props(4)</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      k2      = props(5)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      kdisp   = props(6)</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">C     VISCOUS EFFECTS: MAXWELL ELEMENTS (MAX:3)</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">C      VV       = INT(PROPS(7))</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">C      VSCPROPS = PROPS(8:13)</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">C     NUMERICAL COMPUTATIONS</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      nterm    = 60</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">C     STATE VARIABLES</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="keywordflow">IF</span> ((time(1).EQ.zero).AND.(kstep.EQ.1)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="keyword">CALL </span><a class="code" href="initialize_8for.html#afb6af130004528dffe465dd6b0c53894">initialize</a>(statev)</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="keywordflow">      ENDIF</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">C        READ STATEV</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <span class="keyword">CALL </span><a class="code" href="sdvread_8for.html#aac71ab9ddec68cb5a041a5bfe955190f">sdvread</a>(statev)</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">C      </span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">C---------------------------- KINEMATICS ------------------------------</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">C     DISTORTION GRADIENT</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keyword">CALL </span><a class="code" href="fslip_8for.html#ad2335e079bf9907ca25a55c19e01c333">fslip</a>(dfgrd1,distgr,det,ndi)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">C     INVERSE OF DISTORTION GRADIENT</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keyword">CALL </span><a class="code" href="minverse3d_8for.html#a57fcae0e55c917727e5a5e824f445f4e">matinv3d</a>(dfgrd1,dfgrd1inv,ndi)</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">C     INVERSE OF DISTORTION GRADIENT</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="keyword">CALL </span><a class="code" href="minverse3d_8for.html#a57fcae0e55c917727e5a5e824f445f4e">matinv3d</a>(distgr,distgrinv,ndi)</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">C     CAUCHY-GREEN DEFORMATION TENSORS</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="keyword">CALL </span><a class="code" href="deformation_8for.html#ab2dc1e77c2638cdfcf26b771842db2b7">deformation</a>(dfgrd1,c,b,ndi)</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="keyword">CALL </span><a class="code" href="deformation_8for.html#ab2dc1e77c2638cdfcf26b771842db2b7">deformation</a>(distgr,cbar,bbar,ndi)      </div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">C     FIBER UNIT VECTOR AND STRUCTURAL TENSOR</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="keyword">CALL </span><a class="code" href="fibdir_8for.html#ad4f956d16c26f610a5b52ef9c9da3cf0">fibdir</a>(fibori,m0,mm,nelem,noel,ndi,vorif,vd,distgr,dfgrd1)</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">C     INVARIANTS OF DEVIATORIC DEFORMATION TENSORS</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keyword">CALL </span><a class="code" href="invariants_8for.html#a2c2c5ef734d284a0f4a38320eb18e267">invariants</a>(cbar,cbari1,cbari2,ndi)</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">C      </span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="keyword">CALL </span><a class="code" href="pinvariants_8for.html#aaaa7b07924c642fe785a9a8dc96e885e">pinvariants</a>(cbar,cbari4,ndi,m0,lambda,barlambda,det)</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">C      </span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">C     STRETCH TENSORS</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="keyword">CALL </span><a class="code" href="stretch_8for.html#a35c9d800d4cdf46135fd6fe61edb5fa2">stretch</a>(cbar,bbar,ubar,vbar,ndi)</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">C     ROTATION TENSORS</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keyword">CALL </span><a class="code" href="rotation_8for.html#a75b4b6ad5b953d7b49af0362930cac42">rotation</a>(distgr,rot,ubar,ndi)</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">C     DEVIATORIC PROJECTION TENSORS</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keyword">CALL </span><a class="code" href="proj__eulerian_8for.html#a6c4553cadb8482a8d0484d6d8ff5da18">projeul</a>(unit2,unit4s,proje,ndi)</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="keyword">CALL </span><a class="code" href="proj__lagrangian_8for.html#ad4a855453319c895aa447c6517605e4a">projlag</a>(c,unit4,projl,ndi)</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">C--------------------- CONSTITUTIVE RELATIONS  ------------------------</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">C---- VOLUMETRIC ------------------------------------------------------</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">C     STRAIN-ENERGY AND DERIVATIVES (CHANGE HERE ACCORDING TO YOUR MODEL)</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="keyword">CALL </span><a class="code" href="vol_8for.html#abb3cf83c99202d92dfb8df710243dc63">vol</a>(ssev,pv,ppv,kbulk,det)</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keyword">CALL </span><a class="code" href="isomat_8for.html#a89e735191fd44d7e7535605f29e52600">isomat</a>(sseiso,diso,c10,c01,cbari1,cbari2)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="keyword">CALL </span><a class="code" href="anisomat_8for.html#afa561bbd538fbcb594d34258412f5db5">anisomat</a>(sseaniso,daniso,diso,k1,k2,kdisp,cbari4,cbari1)</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">C---- ISOCHORIC ISOTROPIC ---------------------------------------------</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">C     PK2 &#39;FICTICIOUS&#39; STRESS TENSOR</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <span class="keyword">CALL </span><a class="code" href="pk2isomatfic_8for.html#ade33b1396cbfc5dbb036ee5f6048e9a6">pk2isomatfic</a>(pkmatfic,diso,cbar,cbari1,unit2,ndi)</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">C     CAUCHY &#39;FICTICIOUS&#39; STRESS TENSOR</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keyword">CALL </span><a class="code" href="sigisomatfic_8for.html#a5dc6369258e0cde9daee2a9ccec7972a">sigisomatfic</a>(sisomatfic,pkmatfic,distgr,det,ndi)</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">C     &#39;FICTICIOUS&#39; MATERIAL ELASTICITY TENSOR</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keyword">CALL </span><a class="code" href="cmatisomatfic_8for.html#aefae10fd7e02adb2b87c090a42bb1baa">cmatisomatfic</a>(cmisomatfic,cbar,cbari1,cbari2,</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;     1                          diso,unit2,unit4,det,ndi)</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">C     &#39;FICTICIOUS&#39; SPATIAL ELASTICITY TENSOR</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keyword">CALL </span><a class="code" href="cisomatfic_8for.html#a9bae2c893581a5ef032c8e109eb1ea0c">csisomatfic</a>(cisomatfic,cmisomatfic,distgr,det,ndi)</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">C---- FIBERS (ONE FAMILY)   -------------------------------------------</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keyword">CALL </span><a class="code" href="pk2anisomatfic_8for.html#a73340e181ab9536885f6db31839ba564">pk2anisomatfic</a>(pkmatficaniso,daniso,cbar,cbari4,m0,ndi)</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="keyword">CALL </span><a class="code" href="push2_8for.html#acb1875b4820cb25bf65814b33f47cf99">push2</a>(sanisomatfic,pkmatficaniso,distgr,det,ndi)</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">C      </span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="keyword">CALL </span><a class="code" href="cmatanisomatfic_8for.html#ac0fc260602607e54e92d94a58fb2594d">cmatanisomatfic</a>(cmanisomatfic,m0,daniso,unit2,det,ndi)</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="keyword">CALL </span><a class="code" href="push4_8for.html#a8eaa214e9279f4ea3fa90ff3c0e85f31">push4</a>(canisomatfic,cmanisomatfic,distgr,det,ndi)</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">C     SUM OF ALL ELASTIC CONTRIBUTIONS</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">C     STRAIN-ENERGY</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      sse=ssev+sseiso+sseaniso</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">C     PK2 &#39;FICTICIOUS&#39; STRESS</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      pkfic=pkmatfic+pkmatficaniso</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">C     CAUCHY &#39;FICTICIOUS&#39; STRESS</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      sfic=sisomatfic+sanisomatfic</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">C     MATERIAL &#39;FICTICIOUS&#39; ELASTICITY TENSOR</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      cmfic=cmisomatfic+cmanisomatfic</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">C     SPATIAL &#39;FICTICIOUS&#39; ELASTICITY TENSOR</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      cfic=cisomatfic+canisomatfic</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">C-------------------------- STRESS MEASURES ---------------------------</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">C---- VOLUMETRIC ------------------------------------------------------</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">C      PK2 STRESS</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="keyword">CALL </span><a class="code" href="pk2vol_8for.html#ac9029238abb007c001f636e497ee0ac7">pk2vol</a>(pkvol,pv,c,ndi)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">C      CAUCHY STRESS</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keyword">CALL </span><a class="code" href="sigvol_8for.html#a8d289ee29f4702d72fb71cb2d89c6f12">sigvol</a>(svol,pv,unit2,ndi)</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">C---- ISOCHORIC -------------------------------------------------------</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">C      PK2 STRESS</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keyword">CALL </span><a class="code" href="pk2iso_8for.html#a525f2295f9830b95a6b5ce67d04ea1eb">pk2iso</a>(pkiso,pkfic,projl,det,ndi)</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">C      CAUCHY STRESS</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <span class="keyword">CALL </span><a class="code" href="sigiso_8for.html#a922e87c5383e6f4d45517c30608b0bda">sigiso</a>(siso,sfic,proje,ndi)</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">C---- VOLUMETRIC + ISOCHORIC ------------------------------------------</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">C      PK2 STRESS</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      pk2   = pkvol + pkiso</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">C      CAUCHY STRESS</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      sigma = svol  + siso</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">C-------------------- MATERIAL ELASTICITY TENSOR ----------------------</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">C---- VOLUMETRIC ------------------------------------------------------</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keyword">CALL </span><a class="code" href="metvol_8for.html#af4851b40ff9da9c702d8d02257ee2d41">metvol</a>(cmvol,c,pv,ppv,det,ndi)</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">C---- ISOCHORIC -------------------------------------------------------</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="keyword">CALL </span><a class="code" href="metiso_8for.html#adfb372f50c7b7ab0bbc5abad87205763">metiso</a>(cmiso,cmfic,projl,pkiso,pkfic,c,unit2,det,ndi)</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      ddpkdde=  cmvol + cmiso</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">C--------------------- SPATIAL ELASTICITY TENSOR ----------------------</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">C---- VOLUMETRIC ------------------------------------------------------</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <span class="keyword">CALL </span><a class="code" href="setvol_8for.html#a85643b95cd69b75883847752822f61f4">setvol</a>(cvol,pv,ppv,unit2,unit4s,ndi)</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">C---- ISOCHORIC -------------------------------------------------------</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="keyword">CALL </span><a class="code" href="setiso_8for.html#a684bfc6ac044f6740b76347b3ff89a24">setiso</a>(ciso,cfic,proje,siso,sfic,unit2,ndi)</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">C-----JAUMMAN RATE ----------------------------------------------------</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keyword">CALL </span><a class="code" href="setjr_8for.html#a4501b4a0d0a60316eab4a804e36a3385">setjr</a>(cjr,sigma,unit2,ndi)</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">C     ELASTICITY TENSOR</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      ddsigdde=cvol+ciso+cjr</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">C------------------------- INDEX ALLOCATION ---------------------------</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">C     VOIGT NOTATION  - FULLY SIMMETRY IMPOSED</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <span class="keyword">CALL </span><a class="code" href="index_8for.html#a08f48dba99892c8df390efd4490d66fa">indexx</a>(stress,ddsdde,sigma,ddsigdde,ntens,ndi)</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">C--------------------------- STATE VARIABLES --------------------------</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">C     DO K1 = 1, NTENS</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">C      STATEV(1:27) = VISCOUS TENSORS</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;       <span class="keyword">CALL </span><a class="code" href="sdvwrite_8for.html#a10cc1dd858c5a3789ac6e12fcba396a0">sdvwrite</a>(det,lambda,statev)</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">C     END DO</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">C--------------------------- END OF UMAT ------------------------------</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">C----------------------------------------------------------------------</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="proj__eulerian_8for.html#a6c4553cadb8482a8d0484d6d8ff5da18">projeul</a>(A,AA,PE,NDI)</div><div class="line"><a name="l00443"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a6c4553cadb8482a8d0484d6d8ff5da18">  443</a></span>&#160;<span class="comment">C&gt;    EULERIAN PROJECTION TENSOR</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">C      INPUTS:</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">C          IDENTITY TENSORS - A, AA</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">C      OUTPUTS:</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">C          4TH ORDER SYMMETRIC EULERIAN PROJECTION TENSOR - PE</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="keywordtype">INTEGER</span> I,J,K,L,NDI</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> A(ndi,ndi),AA(ndi,ndi,ndi,ndi),</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;     1                 pe(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <span class="keywordflow">DO</span> i=1,ndi</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;         <span class="keywordflow">DO</span> j=1,ndi</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;          <span class="keywordflow">DO</span> k=1,ndi</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;             <span class="keywordflow">DO</span> l=1,ndi</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;              pe(i,j,k,l)=aa(i,j,k,l)-(one/three)*(a(i,j)*a(k,l))</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="keywordflow">           END DO</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="keywordflow">          END DO</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="proj__eulerian_8for.html#a6c4553cadb8482a8d0484d6d8ff5da18">projeul</a></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="sigvol_8for.html#a8d289ee29f4702d72fb71cb2d89c6f12">sigvol</a>(SVOL,PV,UNIT2,NDI)</div><div class="line"><a name="l00470"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a8d289ee29f4702d72fb71cb2d89c6f12">  470</a></span>&#160;<span class="comment">C&gt;    VOLUMETRIC CAUCHY STRESS </span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <span class="keywordtype">INTEGER</span> NDI,I1,J1</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> UNIT2(ndi,ndi),SVOL(ndi,ndi)</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> PV</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="keywordflow">DO</span> i1=1,ndi</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordflow">DO</span> j1=1,ndi</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;          svol(i1,j1)=pv*unit2(i1,j1)</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="sigvol_8for.html#a8d289ee29f4702d72fb71cb2d89c6f12">sigvol</a></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="isomat_8for.html#a89e735191fd44d7e7535605f29e52600">isomat</a>(SSEISO,DISO,C10,C01,CBARI1,CBARI2)</div><div class="line"><a name="l00487"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a89e735191fd44d7e7535605f29e52600">  487</a></span>&#160;<span class="comment">C&gt;     ISOTROPIC MATRIX : ISOCHORIC SEF AND DERIVATIVES</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> SSEISO,DISO(5)</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> C10,C01,CBARI1,CBARI2</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      sseiso=c10*(cbari1-three)+c01*(cbari2-three)</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      <span class="comment">!FIRST DERIVATIVE OF SSEISO IN ORDER TO I1</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      diso(1)=c10</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="comment">!FIRST DERIVATIVE OF SSEISO IN ORDER TO I2</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      diso(2)=c01</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <span class="comment">!SECOND DERIVATIVE OF SSEISO IN ORDER TO I1</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      diso(3)=zero</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="comment">!SECOND DERIVATIVE OF SSEISO IN ORDER TO I2</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      diso(4)=zero</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="comment">!SECOND DERIVATIVE OF SSEISO IN ORDER TO I1 AND I2</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      diso(5)=zero</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="isomat_8for.html#a89e735191fd44d7e7535605f29e52600">isomat</a></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="sdvread_8for.html#aac71ab9ddec68cb5a041a5bfe955190f">sdvread</a>(STATEV)</div><div class="line"><a name="l00510"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#aac71ab9ddec68cb5a041a5bfe955190f">  510</a></span>&#160;<span class="comment">C&gt;    VISCOUS DISSIPATION: READ STATE VARS</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> STATEV(nsdv)</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">C        read your sdvs here. they should be allocated. </span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">C          after the viscous terms (only if you use viscosity check hvread)</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">!        POS1=9*VV</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">!        DO I1=1,NCH</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">!         POS2=POS1+I1</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">!         FRAC(I1)=STATEV(POS2)</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">!        ENDDO</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="sdvread_8for.html#aac71ab9ddec68cb5a041a5bfe955190f">sdvread</a></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="anisomat_8for.html#afa561bbd538fbcb594d34258412f5db5">anisomat</a>(SSEANISO,DANISO,DISO,K1,K2,KDISP,I4,I1)</div><div class="line"><a name="l00529"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#afa561bbd538fbcb594d34258412f5db5">  529</a></span>&#160;<span class="comment">C&gt;     ANISOTROPIC PART : ISOCHORIC SEF AND DERIVATIVES</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> SSEISO,DANISO(4),DISO(5)</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> K1,K2,KDISP,I4,I1</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> DUDI1,D2UD2I1,SSEANISO</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> E1,EE2,EE3,DUDI4,D2UD2I4,D2DUDI1DI4,D2DUDI2DI4</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      dudi1=diso(1)</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      d2ud2i1=diso(3)</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">C      </span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      e1=i4*(one-three*kdisp)+i1*kdisp-one</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      sseaniso=(k1/k2)*(dexp(k1*e1*e1)-one)</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <span class="keywordflow">IF</span>(e1.GT.zero) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      ee2=dexp(k2*e1*e1)</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      ee3=(one+two*k2*e1*e1)</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      dudi1=dudi1+k1*kdisp*e1*ee2</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      d2ud2i1=d2ud2i1+k1*kdisp*kdisp*ee3*ee2</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">C      </span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      dudi4=k1*(one-three*kdisp)*e1*ee2</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      d2ud2i4=k1*((one-three*kdisp)**two)*ee3*ee2</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      </div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      d2dudi1di4=k1*(one-three*kdisp)*kdisp*ee3*ee2</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      d2dudi2di4=zero</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      dudi4=zero</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      d2ud2i4=zero</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      d2dudi1di4=zero</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      d2dudi2di4=zero</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      d2ud2i1=zero</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="keywordflow">      END IF</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="comment">!FIRST DERIVATIVE OF SSEANISO IN ORDER TO I1</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      daniso(1)=dudi4</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      <span class="comment">!FIRST DERIVATIVE OF SSEANISO IN ORDER TO I2</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      daniso(2)=d2ud2i4</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <span class="comment">!2ND DERIVATIVE OF SSEANISO IN ORDER TO I1</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      daniso(3)=d2dudi1di4</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="comment">!2ND DERIVATIVE OF SSEANISO IN ORDER TO I2</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      daniso(4)=d2dudi2di4</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      diso(1)=dudi1</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      diso(3)=d2ud2i1</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="anisomat_8for.html#afa561bbd538fbcb594d34258412f5db5">anisomat</a></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="pk2vol_8for.html#ac9029238abb007c001f636e497ee0ac7">pk2vol</a>(PKVOL,PV,C,NDI)</div><div class="line"><a name="l00586"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#ac9029238abb007c001f636e497ee0ac7">  586</a></span>&#160;<span class="comment">C&gt;    VOLUMETRIC PK2 STRESS</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <span class="keywordtype">INTEGER</span> NDI,I1,J1</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> PKVOL(ndi,ndi),C(ndi,ndi),CINV(ndi,ndi)</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> PV</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="keyword">CALL </span><a class="code" href="minverse3d_8for.html#a57fcae0e55c917727e5a5e824f445f4e">matinv3d</a>(c,cinv,ndi)</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <span class="keywordflow">DO</span> i1=1,ndi</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="keywordflow">DO</span> j1=1,ndi</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;          pkvol(i1,j1)=pv*cinv(i1,j1)</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="pk2vol_8for.html#ac9029238abb007c001f636e497ee0ac7">pk2vol</a></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="pull4_8for.html#a815133b3937aaf329a48c13107b973c4">pull4</a>(MAT,SPATIAL,FINV,DET,NDI)</div><div class="line"><a name="l00605"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a815133b3937aaf329a48c13107b973c4">  605</a></span>&#160;<span class="comment">C&gt;        PULL-BACK TIMES DET OF 4TH ORDER TENSOR</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;       <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;       include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;       <span class="keywordtype">INTEGER</span> I1,J1,K1,L1,II1,JJ1,KK1,LL1,NDI</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> MAT(ndi,ndi,ndi,ndi),FINV(ndi,ndi)</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> SPATIAL(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> AUX,DET</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;       <span class="keywordflow">DO</span> i1=1,ndi</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="keywordflow">DO</span> j1=1,ndi</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;         <span class="keywordflow">DO</span> k1=1,ndi</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;          <span class="keywordflow">DO</span> l1=1,ndi</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;           aux=zero</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;           <span class="keywordflow">DO</span> ii1=1,ndi</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            <span class="keywordflow">DO</span> jj1=1,ndi</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;             <span class="keywordflow">DO</span> kk1=1,ndi</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;              <span class="keywordflow">DO</span> ll1=1,ndi</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;              aux=aux+det*</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;     +        finv(i1,ii1)*finv(j1,jj1)*</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;     +        finv(k1,kk1)*finv(l1,ll1)*spatial(ii1,jj1,kk1,ll1)</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="keywordflow">              END DO</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="keywordflow">             END DO</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="keywordflow">           END DO</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;           mat(i1,j1,k1,l1)=aux</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="keywordflow">          END DO</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="keywordflow">         END DO</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="keywordflow">       END DO</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;       <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="pull4_8for.html#a815133b3937aaf329a48c13107b973c4">pull4</a></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="setjr_8for.html#a4501b4a0d0a60316eab4a804e36a3385">setjr</a>(CJR,SIGMA,UNIT2,NDI)</div><div class="line"><a name="l00639"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a4501b4a0d0a60316eab4a804e36a3385">  639</a></span>&#160;<span class="comment">C&gt;    JAUMAN RATE CONTRIBUTION FOR THE SPATIAL ELASTICITY TENSOR</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      <span class="keywordtype">INTEGER</span> NDI,I1,J1,K1,L1</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> UNIT2(ndi,ndi),</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;     1                 cjr(ndi,ndi,ndi,ndi),sigma(ndi,ndi)</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="keywordflow">DO</span> i1 = 1, ndi</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        <span class="keywordflow">DO</span> j1 = 1, ndi</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;         <span class="keywordflow">DO</span> k1 = 1, ndi</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;           <span class="keywordflow">DO</span> l1 = 1, ndi</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;              cjr(i1,j1,k1,l1)=</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;     1             (one/two)*(unit2(i1,k1)*sigma(j1,l1)</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;     2             +sigma(i1,k1)*unit2(j1,l1)+unit2(i1,l1)*sigma(j1,k1)</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;     3             +sigma(i1,l1)*unit2(j1,k1))</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="keywordflow">           END DO</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="keywordflow">         END DO</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="setjr_8for.html#a4501b4a0d0a60316eab4a804e36a3385">setjr</a></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="contraction44_8for.html#ad99a62a07d01f333320f807d2c991a51">contraction44</a>(S,LT,RT,NDI)</div><div class="line"><a name="l00663"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#ad99a62a07d01f333320f807d2c991a51">  663</a></span>&#160;<span class="comment">C&gt;       DOUBLE CONTRACTION BETWEEN 4TH ORDER TENSORS</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">C&gt;      INPUT:</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">C&gt;       LT - RIGHT 4TH ORDER TENSOR</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">C&gt;       RT - LEFT  4TH ORDER TENSOR</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">C&gt;      OUTPUT:</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">C&gt;       S - DOUBLE CONTRACTED TENSOR (4TH ORDER)</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;       <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;       include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;       <span class="keywordtype">INTEGER</span> I1,J1,K1,L1,M1,N1,NDI</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> LT(ndi,ndi,ndi,ndi),RT(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> S(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> AUX</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">C                     </span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;       <span class="keywordflow">DO</span> i1=1,ndi</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="keywordflow">DO</span> j1=1,ndi</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;         <span class="keywordflow">DO</span> k1=1,ndi</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;          <span class="keywordflow">DO</span> l1=1,ndi</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;           aux=zero</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;           <span class="keywordflow">DO</span> m1=1,ndi</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            <span class="keywordflow">DO</span> n1=1,ndi</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                aux=aux+lt(i1,j1,m1,n1)*rt(m1,n1,k1,l1)</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="keywordflow">           END DO</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;           s(i1,j1,k1,l1)=aux</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="keywordflow">          END DO</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="keywordflow">         END DO</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="keywordflow">       END DO</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;       <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="contraction44_8for.html#ad99a62a07d01f333320f807d2c991a51">contraction44</a></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="keyword">       SUBROUTINE </span><a class="code" href="initialize_8for.html#afb6af130004528dffe465dd6b0c53894">initialize</a>(STATEV)</div><div class="line"><a name="l00697"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#afb6af130004528dffe465dd6b0c53894">  697</a></span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">C      </span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">C      COMMON /KCOMMON/KBLOCK</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">C      DOUBLE PRECISION TIME(2),KSTEP</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      <span class="keywordtype">INTEGER</span> I1,POS,POS1,POS2,POS3</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> STATEV(nsdv)</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">C        DETERMINANT</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        statev(1)=one    </div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">C     </span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="initialize_8for.html#afb6af130004528dffe465dd6b0c53894">initialize</a></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="setvol_8for.html#a85643b95cd69b75883847752822f61f4">setvol</a>(CVOL,PV,PPV,UNIT2,UNIT4S,NDI)</div><div class="line"><a name="l00713"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a85643b95cd69b75883847752822f61f4">  713</a></span>&#160;<span class="comment">C&gt;    VOLUMETRIC SPATIAL ELASTICITY TENSOR</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <span class="keywordtype">INTEGER</span> NDI,I1,J1,K1,L1</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> UNIT2(ndi,ndi),UNIT4S(ndi,ndi,ndi,ndi),</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;     1                 cvol(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> PV,PPV</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      <span class="keywordflow">DO</span> i1 = 1, ndi</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="keywordflow">DO</span> j1 = 1, ndi</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;         <span class="keywordflow">DO</span> k1 = 1, ndi</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;           <span class="keywordflow">DO</span> l1 = 1, ndi</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;             cvol(i1,j1,k1,l1)=</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;     1                 ppv*unit2(i1,j1)*unit2(k1,l1)</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;     2                 -two*pv*unit4s(i1,j1,k1,l1)</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="keywordflow">           END DO</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="keywordflow">         END DO</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">C      </span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="setvol_8for.html#a85643b95cd69b75883847752822f61f4">setvol</a></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="pk2isomatfic_8for.html#ade33b1396cbfc5dbb036ee5f6048e9a6">pk2isomatfic</a>(FIC,DISO,CBAR,CBARI1,UNIT2,NDI)</div><div class="line"><a name="l00737"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#ade33b1396cbfc5dbb036ee5f6048e9a6">  737</a></span>&#160;<span class="comment">C&gt;     ISOTROPIC MATRIX: 2PK &#39;FICTICIOUS&#39; STRESS TENSOR</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment">C      INPUT:</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment">C       DISO - STRAIN-ENERGY DERIVATIVES</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment">C       CBAR - DEVIATORIC LEFT CAUCHY-GREEN TENSOR</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">C       CBARI1,CBARI2 - CBAR INVARIANTS</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">C       UNIT2 - 2ND ORDER IDENTITY TENSOR</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">C      OUTPUT:</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">C       FIC - 2ND PIOLA KIRCHOOF &#39;FICTICIOUS&#39; STRESS TENSOR</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      <span class="keywordtype">INTEGER</span> I1,J1,NDI</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> FIC(ndi,ndi),DISO(5),CBAR(ndi,ndi),UNIT2(ndi,ndi)</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> DUDI1,DUDI2,CBARI1</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> AUX1,AUX2    </div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      dudi1=diso(1)</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      dudi2=diso(2)</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      aux1=two*(dudi1+cbari1*dudi2)</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      aux2=-two*dudi2</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      <span class="keywordflow">DO</span> i1=1,ndi</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;       <span class="keywordflow">DO</span> j1=1,ndi</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        fic(i1,j1)=aux1*unit2(i1,j1)+aux2*cbar(i1,j1)</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="keywordflow">       END DO</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="pk2isomatfic_8for.html#ade33b1396cbfc5dbb036ee5f6048e9a6">pk2isomatfic</a></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="uexternaldb_8for.html#af82fa72f6d0f9acdbf18f2de5016962b">uexternaldb</a>(LOP,LRESTART,TIME,DTIME,KSTEP,KINC)</div><div class="line"><a name="l00768"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#af82fa72f6d0f9acdbf18f2de5016962b">  768</a></span>&#160;<span class="comment">C&gt;    READ MESH DATA</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      include <span class="stringliteral">&#39;ABA_PARAM.INC&#39;</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">C     UEXTERNAL just called once; work in parallel computing</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">C     ADD COMMON BLOCKS HERE IF NEEDED (and in UMAT)</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">C      COMMON /KBLOCK/KBLOCK</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <span class="keyword">COMMON</span> /kfib/fibori</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">C           </span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      <span class="keywordtype">REAL*8</span> DTIME</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      dimension time(2)</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <span class="keywordtype">CHARACTER(256)</span> FILENAME</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      <span class="keywordtype">CHARACTER(256)</span> JOBDIR</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      <span class="keywordtype">INTEGER</span>  LENJOBDIR</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      </div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <span class="keywordtype">REAL*8</span> FIBORI(nelem,4)</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      </div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment">C     LOP=0 --&gt; START OF THE ANALYSIS</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      <span class="keywordflow">IF</span>(lop.EQ.0.OR.lop.EQ.4) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;       <span class="keyword">CALL </span><a class="code" href="_g_e_t_o_u_t_d_i_r_8for.html#a76d92cb7acf0fa97519e0cc1c71cf219">getoutdir</a>(jobdir,lenjobdir)</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">C        DIR1 DEFNIED IN PARAM_UMAT.INC</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;         filename=jobdir(:lenjobdir)//<span class="stringliteral">&#39;/&#39;</span>//dir1</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;         <span class="keyword">OPEN</span>(15,file=filename)</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;         <span class="keywordflow">DO</span> i=1,nelem</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            <span class="keyword">READ</span>(15,*) (fibori(i,j),j=1,4)</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="keywordflow">         END DO</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;          <span class="keyword">CLOSE</span>(15)</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">!C         </span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="keywordflow">      END IF</span>    </div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="uexternaldb_8for.html#af82fa72f6d0f9acdbf18f2de5016962b">uexternaldb</a></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="sigisomatfic_8for.html#a5dc6369258e0cde9daee2a9ccec7972a">sigisomatfic</a>(SFIC,PKFIC,F,DET,NDI)</div><div class="line"><a name="l00804"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a5dc6369258e0cde9daee2a9ccec7972a">  804</a></span>&#160;<span class="comment">C&gt;    ISOTROPIC MATRIX:  ISOCHORIC CAUCHY STRESS </span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="keywordtype">INTEGER</span> NDI</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> SFIC(ndi,ndi),F(ndi,ndi),</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;     1                 pkfic(ndi,ndi)</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> DET</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      <span class="keyword">CALL </span><a class="code" href="push2_8for.html#acb1875b4820cb25bf65814b33f47cf99">push2</a>(sfic,pkfic,f,det,ndi)</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="sigisomatfic_8for.html#a5dc6369258e0cde9daee2a9ccec7972a">sigisomatfic</a></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="pk2anisomatfic_8for.html#a73340e181ab9536885f6db31839ba564">pk2anisomatfic</a>(AFIC,DANISO,CBAR,INV4,ST0,NDI)</div><div class="line"><a name="l00818"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a73340e181ab9536885f6db31839ba564">  818</a></span>&#160;<span class="comment">C&gt;      ANISOTROPIC MATRIX: 2PK &#39;FICTICIOUS&#39; STRESS TENSOR</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">C       INPUT:</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">C       DANISO - ANISOTROPIC STRAIN-ENERGY DERIVATIVES</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">C       CBAR - DEVIATORIC LEFT CAUCHY-GREEN TENSOR</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">C       INV1,INV4 -CBAR INVARIANTS</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">C       UNIT2 - 2ND ORDER IDENTITY TENSOR</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">C       OUTPUT:</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">C       AFIC - 2ND PIOLA KIRCHOOF &#39;FICTICIOUS&#39; STRESS TENSOR</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="keywordtype">INTEGER</span> NDI</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> AFIC(ndi,ndi),DANISO(3),CBAR(3,3)</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> DUDI4,DI4DC(3,3),INV4</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> ST0(3,3)</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment">C-----------------------------------------------------------------------------</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      <span class="comment">!FIRST DERIVATIVE OF SSEANISO IN ORDER TO I4</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      dudi4=daniso(1)</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      di4dc=st0</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      afic=two*(dudi4*di4dc)</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="pk2anisomatfic_8for.html#a73340e181ab9536885f6db31839ba564">pk2anisomatfic</a></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="stretch_8for.html#a35c9d800d4cdf46135fd6fe61edb5fa2">stretch</a>(C,B,U,V,NDI)</div><div class="line"><a name="l00846"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a35c9d800d4cdf46135fd6fe61edb5fa2">  846</a></span>&#160;<span class="comment">C&gt;    STRETCH TENSORS</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      <span class="keywordtype">INTEGER</span> NDI</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> C(ndi,ndi),B(ndi,ndi),U(ndi,ndi),V(ndi,ndi)</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> EIGVAL(ndi),OMEGA(ndi),EIGVEC(ndi,ndi)</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      <span class="keyword">CALL </span><a class="code" href="spectral_8for.html#a801551e9f01a5150209f80d289d6d41c">spectral</a>(c,omega,eigvec)</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      eigval(1) = dsqrt(omega(1))</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      eigval(2) = dsqrt(omega(2))</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      eigval(3) = dsqrt(omega(3))</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      u(1,1) = eigval(1)</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      u(2,2) = eigval(2)</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      u(3,3) = eigval(3)</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      u = matmul(matmul(eigvec,u),transpose(eigvec))</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <span class="keyword">CALL </span><a class="code" href="spectral_8for.html#a801551e9f01a5150209f80d289d6d41c">spectral</a>(b,omega,eigvec)</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      eigval(1) = dsqrt(omega(1))</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      eigval(2) = dsqrt(omega(2))</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      eigval(3) = dsqrt(omega(3))      </div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">C      write(*,*) eigvec(1,1),eigvec(2,1),eigvec(3,1)</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      v(1,1) = eigval(1)</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      v(2,2) = eigval(2)</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      v(3,3) = eigval(3)</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      v = matmul(matmul(eigvec,v),transpose(eigvec))</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="stretch_8for.html#a35c9d800d4cdf46135fd6fe61edb5fa2">stretch</a></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="minverse3d_8for.html#a57fcae0e55c917727e5a5e824f445f4e">matinv3d</a>(A,A_INV,NDI)</div><div class="line"><a name="l00881"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a57fcae0e55c917727e5a5e824f445f4e">  881</a></span>&#160;<span class="comment">C&gt;    INVERSE OF A 3X3 MATRIX</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">C     RETURN THE INVERSE OF A(3,3) - A_INV</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      <span class="keywordtype">INTEGER</span> NDI</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> A(ndi,ndi),A_INV(ndi,ndi),DET_A,DET_A_INV</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      det_a = a(1,1)*(a(2,2)*a(3,3) - a(3,2)*a(2,3)) -</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;     +        a(2,1)*(a(1,2)*a(3,3) - a(3,2)*a(1,3)) +</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;     +        a(3,1)*(a(1,2)*a(2,3) - a(2,2)*a(1,3))</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      <span class="keywordflow">IF</span> (det_a .LE. 0.d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;WARNING: SUBROUTINE MATINV3D:&#39;</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;WARNING: DET OF MAT=&#39;</span>,det_a</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="keywordflow">      END IF</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      det_a_inv = 1.d0/det_a</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      a_inv(1,1) = det_a_inv*(a(2,2)*a(3,3)-a(3,2)*a(2,3))</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      a_inv(1,2) = det_a_inv*(a(3,2)*a(1,3)-a(1,2)*a(3,3))</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      a_inv(1,3) = det_a_inv*(a(1,2)*a(2,3)-a(2,2)*a(1,3))</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      a_inv(2,1) = det_a_inv*(a(3,1)*a(2,3)-a(2,1)*a(3,3))</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      a_inv(2,2) = det_a_inv*(a(1,1)*a(3,3)-a(3,1)*a(1,3))</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      a_inv(2,3) = det_a_inv*(a(2,1)*a(1,3)-a(1,1)*a(2,3))</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      a_inv(3,1) = det_a_inv*(a(2,1)*a(3,2)-a(3,1)*a(2,2))</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      a_inv(3,2) = det_a_inv*(a(3,1)*a(1,2)-a(1,1)*a(3,2))</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      a_inv(3,3) = det_a_inv*(a(1,1)*a(2,2)-a(2,1)*a(1,2))</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="minverse3d_8for.html#a57fcae0e55c917727e5a5e824f445f4e">matinv3d</a></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="spectral_8for.html#a801551e9f01a5150209f80d289d6d41c">spectral</a>(A,D,V)</div><div class="line"><a name="l00914"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a801551e9f01a5150209f80d289d6d41c">  914</a></span>&#160;<span class="comment">C&gt;    EIGENVALUES AND EIGENVECTOR OF A 3X3 MATRIX</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">C     THIS SUBROUTINE CALCULATES THE EIGENVALUES AND EIGENVECTORS OF</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">C     A SYMMETRIC 3X3 MATRIX A.</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">C     THE OUTPUT CONSISTS OF A VECTOR D CONTAINING THE THREE</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">C     EIGENVALUES IN ASCENDING ORDER, AND A MATRIX V WHOSE</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment">C     COLUMNS CONTAIN THE CORRESPONDING EIGENVECTORS.</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      <span class="keywordtype">INTEGER</span> NP,NROT</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      parameter(np=3)</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> D(3),V(3,3),A(3,3),E(3,3)</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      e = a</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      <span class="keyword">CALL </span><a class="code" href="spectral_8for.html#af30a892ec55877718024cfef2cee100e">jacobi</a>(e,3,np,d,v,nrot)</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;      <span class="keyword">CALL </span><a class="code" href="spectral_8for.html#a4cefa75528ebe8935b50d575c9042b3c">eigsrt</a>(d,v,3,np)</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="spectral_8for.html#a801551e9f01a5150209f80d289d6d41c">spectral</a></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment">C***********************************************************************</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="spectral_8for.html#af30a892ec55877718024cfef2cee100e">jacobi</a>(A,N,NP,D,V,NROT)</div><div class="line"><a name="l00940"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#af30a892ec55877718024cfef2cee100e">  940</a></span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">C COMPUTES ALL EIGENVALUES AND EIGENVECTORS OF A REAL SYMMETRIC</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">C  MATRIX A, WHICH IS OF SIZE N BY N, STORED IN A PHYSICAL</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">C  NP BY NP ARRAY.  ON OUTPUT, ELEMENTS OF A ABOVE THE DIAGONAL</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">C  ARE DESTROYED, BUT THE DIAGONAL AND SUB-DIAGONAL ARE UNCHANGED</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">C  AND GIVE FULL INFORMATION ABOUT THE ORIGINAL SYMMETRIC MATRIX.</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">C  VECTOR D RETURNS THE EIGENVALUES OF A IN ITS FIRST N ELEMENTS.</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">C  V IS A MATRIX WITH THE SAME LOGICAL AND PHYSICAL DIMENSIONS AS</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">C  A WHOSE COLUMNS CONTAIN, UPON OUTPUT, THE NORMALIZED</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">C  EIGENVECTORS OF A.  NROT RETURNS THE NUMBER OF JACOBI ROTATION</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">C  WHICH WERE REQUIRED.</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">C THIS SUBROUTINE IS TAKEN FROM &#39;NUMERICAL RECIPES.&#39;</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <span class="keywordtype">INTEGER</span> IP,IQ,N,NMAX,NP,NROT,I,J</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      parameter(nmax=100)</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> A(np,np),D(np),V(np,np),B(nmax),Z(nmax),</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;     +  sm,tresh,g,t,h,theta,s,c,tau</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">C INITIALIZE V TO THE IDENTITY MATRIX</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      <span class="keywordflow">DO</span> i=1,3</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;          v(i,i)=one</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <span class="keywordflow">DO</span> j=1,3</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;          <span class="keywordflow">IF</span> (i.NE.j)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;           v(i,j)=zero</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="keywordflow">         ENDIF</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="keywordflow">       END DO</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">C INITIALIZE B AND D TO THE DIAGONAL OF A, AND Z TO ZERO.</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">C  THE VECTOR Z WILL ACCUMULATE TERMS OF THE FORM T*A_PQ AS</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment">C  IN EQUATION (11.1.14)</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      <span class="keywordflow">DO</span> ip = 1,n</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        b(ip) = a(ip,ip)</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        d(ip) = b(ip)</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        z(ip) = 0.d0</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">C BEGIN ITERATION</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      nrot = 0</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="keywordflow">DO</span> i=1,50</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">C         SUM OFF-DIAGONAL ELEMENTS</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;          sm = 0.d0</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;          <span class="keywordflow">DO</span> ip=1,n-1</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            <span class="keywordflow">DO</span> iq=ip+1,n</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;              sm = sm + dabs(a(ip,iq))</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="keywordflow">          END DO</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">C          IF SM = 0., THEN RETURN.  THIS IS THE NORMAL RETURN,</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">C          WHICH RELIES ON QUADRATIC CONVERGENCE TO MACHINE</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">C          UNDERFLOW.</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;          <span class="keywordflow">IF</span> (sm.EQ.0.d0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">C          IN THE FIRST THREE SWEEPS CARRY OUT THE PQ ROTATION ONLY IF</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">C           |A_PQ| &gt; TRESH, WHERE TRESH IS SOME THRESHOLD VALUE,</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">C           SEE EQUATION (11.1.25).  THEREAFTER TRESH = 0.</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;          <span class="keywordflow">IF</span> (i.LT.4) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;            tresh = 0.2d0*sm/n**2</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;          <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;            tresh = 0.d0</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="keywordflow">          END IF</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;          <span class="keywordflow">DO</span> ip=1,n-1</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;            <span class="keywordflow">DO</span> iq=ip+1,n</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;              g = 100.d0*dabs(a(ip,iq))</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">C              AFTER FOUR SWEEPS, SKIP THE ROTATION IF THE</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">C               OFF-DIAGONAL ELEMENT IS SMALL.</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;              <span class="keywordflow">IF</span> ((i.GT.4).AND.(dabs(d(ip))+g.EQ.dabs(d(ip)))</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;     +            .AND.(dabs(d(iq))+g.EQ.dabs(d(iq)))) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                a(ip,iq) = 0.d0</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (dabs(a(ip,iq)).GT.tresh) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                h = d(iq) - d(ip)</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                <span class="keywordflow">IF</span> (dabs(h)+g.EQ.dabs(h)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">C                  T = 1./(2.*THETA), EQUATION (11.1.10)</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                  t =a(ip,iq)/h</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                  theta = 0.5d0*h/a(ip,iq)</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                  t =1.d0/(dabs(theta)+dsqrt(1.d0+theta**2.d0))</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                  <span class="keywordflow">IF</span> (theta.LT.0.d0) t = -t</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                c = 1.d0/dsqrt(1.d0 + t**2.d0)</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                s = t*c</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                tau = s/(1.d0 + c)</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                h = t*a(ip,iq)</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                z(ip) = z(ip) - h</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                z(iq) = z(iq) + h</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                d(ip) = d(ip) - h</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                d(iq) = d(iq) + h</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                a(ip,iq) = 0.d0</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">C               CASE OF ROTATIONS 1 &lt;= J &lt; P</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                <span class="keywordflow">DO</span> j=1,ip-1</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                  g = a(j,ip)</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                  h = a(j,iq)</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                  a(j,ip) = g - s*(h + g*tau)</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                  a(j,iq) = h + s*(g - h*tau)</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">C                CASE OF ROTATIONS P &lt; J &lt; Q</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                <span class="keywordflow">DO</span> j=ip+1,iq-1</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                  g = a(ip,j)</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                  h = a(j,iq)</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                  a(ip,j) = g - s*(h + g*tau)</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                  a(j,iq) = h + s*(g - h*tau)</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment">C                 CASE OF ROTATIONS Q &lt; J &lt;= N</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                <span class="keywordflow">DO</span> j=iq+1,n</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                  g = a(ip,j)</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                  h = a(iq,j)</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                  a(ip,j) = g - s*(h + g*tau)</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                  a(iq,j) = h + s*(g - h*tau)</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                <span class="keywordflow">DO</span> j = 1,n</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                  g = v(j,ip)</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                  h = v(j,iq)</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                  v(j,ip) = g - s*(h + g*tau)</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                  v(j,iq) = h + s*(g - h*tau)</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                nrot = nrot + 1</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="keywordflow">             END IF</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="keywordflow">             END DO</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">C          UPDATE D WITH THE SUM OF T*A_PQ, AND REINITIALIZE Z</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;       <span class="keywordflow">DO</span> ip=1,n</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;         b(ip) = b(ip) + z(ip)</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;         d(ip) = b(ip)</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;         z(ip) = 0.d0</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="keywordflow">       END DO</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment">C IF THE ALGORITHM HAS REACHED THIS STAGE, THEN THERE</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">C  ARE TOO MANY SWEEPS.  PRINT A DIAGNOSTIC AND CUT THE</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">C  TIME INCREMENT.</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;      <span class="keyword">WRITE</span> (*,<span class="stringliteral">&#39;(/1X,A/)&#39;</span>) <span class="stringliteral">&#39;50 ITERATIONS IN JACOBI SHOULD NEVER HAPPEN&#39;</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="spectral_8for.html#af30a892ec55877718024cfef2cee100e">jacobi</a></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">C**********************************************************************</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="spectral_8for.html#a4cefa75528ebe8935b50d575c9042b3c">eigsrt</a>(D,V,N,NP)</div><div class="line"><a name="l01103"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a4cefa75528ebe8935b50d575c9042b3c"> 1103</a></span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">C     GIVEN THE EIGENVALUES D AND EIGENVECTORS V AS OUTPUT FROM</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment">C     JACOBI, THIS SUBROUTINE SORTS THE EIGENVALUES INTO ASCENDING</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">C     ORDER AND REARRANGES THE COLMNS OF V ACCORDINGLY.</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">C     THE SUBROUTINE WAS TAKEN FROM &#39;NUMERICAL RECIPES.&#39;</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <span class="keywordtype">INTEGER</span> N,NP,I,J,K</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> D(np),V(np,np),P</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <span class="keywordflow">DO</span> i=1,n-1</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;              k = i</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;              p = d(i)</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;              <span class="keywordflow">DO</span> j=i+1,n</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;               <span class="keywordflow">IF</span> (d(j).GE.p) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                k = j</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                p = d(j)</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="keywordflow">               END IF</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="keywordflow">              END DO</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;              <span class="keywordflow">IF</span> (k.NE.i) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;               d(k) = d(i)</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;               d(i) = p</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;               <span class="keywordflow">DO</span> j=1,n</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                p = v(j,i)</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                v(j,i) = v(j,k)</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                v(j,k) = p</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="keywordflow">              END IF</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="spectral_8for.html#a4cefa75528ebe8935b50d575c9042b3c">eigsrt</a></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="keyword">       SUBROUTINE </span><a class="code" href="tensorprod22_8for.html#ade4458c8350bdd937ff4405df54f6328">tensorprod2</a>(A,B,C,NDI)</div><div class="line"><a name="l01139"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#ade4458c8350bdd937ff4405df54f6328"> 1139</a></span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;       <span class="keywordtype">Implicit None</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;       <span class="keywordtype">INTEGER</span> I,J,K,L,NDI</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> A(ndi,ndi),B(ndi,ndi),C(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      <span class="keywordflow">DO</span> i=1,ndi</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;       <span class="keywordflow">DO</span> j=1,ndi</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;         <span class="keywordflow">DO</span> k=1,ndi</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;          <span class="keywordflow">DO</span> l=1,ndi</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;          c(i,j,k,l)=a(i,j)*b(k,l)</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="keywordflow">          END DO</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="keywordflow">         END DO</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="keywordflow">       END DO</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="keyword">      end SUBROUTINE </span><a class="code" href="tensorprod22_8for.html#ade4458c8350bdd937ff4405df54f6328">tensorprod2</a></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="contraction24_8for.html#a1a863241d0a7a2151c797ceaa85e3be4">contraction24</a>(S,LT,RT,NDI)</div><div class="line"><a name="l01160"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a1a863241d0a7a2151c797ceaa85e3be4"> 1160</a></span>&#160;<span class="comment">C&gt;       DOUBLE CONTRACTION BETWEEN 4TH ORDER AND 2ND ORDER  TENSOR</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="comment">C&gt;      INPUT:</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment">C&gt;       LT - RIGHT 2ND ORDER TENSOR</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="comment">C&gt;       RT - LEFT  4TH ODER TENSOR</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="comment">C&gt;      OUTPUT:</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="comment">C&gt;       S - DOUBLE CONTRACTED TENSOR (2ND ORDER)</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;       <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;       include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;       <span class="keywordtype">INTEGER</span> I1,J1,K1,L1,NDI</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> LT(ndi,ndi),RT(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> S(ndi,ndi)</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> AUX</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      <span class="keywordflow">DO</span> k1=1,ndi</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;       <span class="keywordflow">DO</span> l1=1,ndi</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;         aux=zero</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        <span class="keywordflow">DO</span> i1=1,ndi</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;         <span class="keywordflow">DO</span> j1=1,ndi</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;           aux=aux+lt(k1,l1)*rt(i1,j1,k1,l1)</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="keywordflow">       END DO</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;          s(k1,l1)=aux</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;       <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="contraction24_8for.html#a1a863241d0a7a2151c797ceaa85e3be4">contraction24</a></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="invariants_8for.html#a2c2c5ef734d284a0f4a38320eb18e267">invariants</a>(A,INV1,INV2,NDI)</div><div class="line"><a name="l01189"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a2c2c5ef734d284a0f4a38320eb18e267"> 1189</a></span>&#160;<span class="comment">C&gt;    1ST AND 2ND INVARIANTS OF A TENSOR</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      <span class="keywordtype">INTEGER</span> NDI,I1</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> A(ndi,ndi),AA(ndi,ndi)</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> INV1,INV1AA, INV2</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      inv1=zero</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;      inv1aa=zero</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      aa=matmul(a,a)</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      <span class="keywordflow">DO</span> i1=1,ndi</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;         inv1=inv1+a(i1,i1)</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;         inv1aa=inv1aa+aa(i1,i1)</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;         inv2=(one/two)*(inv1*inv1-inv1aa)</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="invariants_8for.html#a2c2c5ef734d284a0f4a38320eb18e267">invariants</a></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="sigiso_8for.html#a922e87c5383e6f4d45517c30608b0bda">sigiso</a>(SISO,SFIC,PE,NDI)</div><div class="line"><a name="l01209"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a922e87c5383e6f4d45517c30608b0bda"> 1209</a></span>&#160;<span class="comment">C&gt;    ISOCHORIC CAUCHY STRESS </span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      <span class="keywordtype">INTEGER</span> NDI</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> SISO(ndi,ndi),</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;     1                 pe(ndi,ndi,ndi,ndi),sfic(ndi,ndi)</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      <span class="keyword">CALL </span><a class="code" href="contraction42_8for.html#aad71a324137b3d597992a6ba4386bc1c">contraction42</a>(siso,pe,sfic,ndi)</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="sigiso_8for.html#a922e87c5383e6f4d45517c30608b0bda">sigiso</a></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="vol_8for.html#abb3cf83c99202d92dfb8df710243dc63">vol</a>(SSEV,PV,PPV,K,DET)</div><div class="line"><a name="l01222"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#abb3cf83c99202d92dfb8df710243dc63"> 1222</a></span>&#160;<span class="comment">C&gt;     VOLUMETRIC CONTRIBUTION :STRAIN ENERGY FUNCTION AND DERIVATIVES</span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> SSEV,PV,PPV</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> K,G,DET,AUX</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      g=(one/four)*(det*det-one-two*log(det))</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      ssev=k*g</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      pv=k*(one/two)*(det-one/det)</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      aux=k*(one/two)*(one+one/(det*det))</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      ppv=pv+det*aux</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="vol_8for.html#abb3cf83c99202d92dfb8df710243dc63">vol</a></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="push4_8for.html#a8eaa214e9279f4ea3fa90ff3c0e85f31">push4</a>(SPATIAL,MAT,F,DET,NDI)</div><div class="line"><a name="l01240"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a8eaa214e9279f4ea3fa90ff3c0e85f31"> 1240</a></span>&#160;<span class="comment">C&gt;        PIOLA TRANSFORMATION</span></div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="comment">C&gt;      INPUT:</span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="comment">C&gt;       MAT - MATERIAL ELASTICITY TENSOR</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="comment">C&gt;       F - DEFORMATION GRADIENT</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="comment">C&gt;       DET - DEFORMATION DETERMINANT</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="comment">C&gt;      OUTPUT:</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">C&gt;       SPATIAL - SPATIAL ELASTICITY TENSOR</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;       <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;       include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;       <span class="keywordtype">INTEGER</span> I1,J1,K1,L1,II1,JJ1,KK1,LL1,NDI</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> MAT(ndi,ndi,ndi,ndi),F(ndi,ndi)</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> SPATIAL(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> AUX,DET</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;       <span class="keywordflow">DO</span> i1=1,ndi</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <span class="keywordflow">DO</span> j1=1,ndi</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;         <span class="keywordflow">DO</span> k1=1,ndi</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;          <span class="keywordflow">DO</span> l1=1,ndi</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;           aux=zero</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;           <span class="keywordflow">DO</span> ii1=1,ndi</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            <span class="keywordflow">DO</span> jj1=1,ndi</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;             <span class="keywordflow">DO</span> kk1=1,ndi</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;              <span class="keywordflow">DO</span> ll1=1,ndi</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;              aux=aux+(det**(-one))*</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;     +        f(i1,ii1)*f(j1,jj1)*</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;     +        f(k1,kk1)*f(l1,ll1)*mat(ii1,jj1,kk1,ll1)</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="keywordflow">              END DO</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="keywordflow">             END DO</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="keywordflow">           END DO</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;           spatial(i1,j1,k1,l1)=aux</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="keywordflow">          END DO</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="keywordflow">         END DO</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="keywordflow">       END DO</span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;       <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="push4_8for.html#a8eaa214e9279f4ea3fa90ff3c0e85f31">push4</a></div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="pk2iso_8for.html#a525f2295f9830b95a6b5ce67d04ea1eb">pk2iso</a>(PKISO,PKFIC,PL,DET,NDI)</div><div class="line"><a name="l01281"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a525f2295f9830b95a6b5ce67d04ea1eb"> 1281</a></span>&#160;<span class="comment">C&gt;    ISOCHORIC PK2 STRESS TENSOR</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;      <span class="keywordtype">INTEGER</span> NDI,I1,J1</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> PKISO(ndi,ndi),</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;     1                 pl(ndi,ndi,ndi,ndi),pkfic(ndi,ndi)</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> DET,SCALE2      </div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      <span class="keyword">CALL </span><a class="code" href="contraction42_8for.html#aad71a324137b3d597992a6ba4386bc1c">contraction42</a>(pkiso,pl,pkfic,ndi)</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      scale2=det**(-two/three)</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      <span class="keywordflow">DO</span> i1=1,ndi</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        <span class="keywordflow">DO</span> j1=1,ndi</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;          pkiso(i1,j1)=scale2*pkiso(i1,j1)</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="pk2iso_8for.html#a525f2295f9830b95a6b5ce67d04ea1eb">pk2iso</a></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="identity__tensors_8for.html#a03fd2442d72065c8a2c3cfb10467ceb6">onem</a>(A,AA,AAS,NDI)</div><div class="line"><a name="l01302"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a03fd2442d72065c8a2c3cfb10467ceb6"> 1302</a></span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="comment">C&gt;      THIS SUBROUTINE GIVES:</span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="comment">C&gt;          2ND ORDER IDENTITY TENSORS - A</span></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="comment">C&gt;          4TH ORDER IDENTITY TENSOR - AA</span></div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="comment">C&gt;          4TH ORDER SYMMETRIC IDENTITY TENSOR - AAS</span></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      <span class="keywordtype">INTEGER</span> I,J,K,L,NDI</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> A(ndi,ndi),AA(ndi,ndi,ndi,ndi),</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;     1                 aas(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      <span class="keywordflow">DO</span> i=1,ndi</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;         <span class="keywordflow">DO</span> j=1,ndi</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;            <span class="keywordflow">IF</span> (i .EQ. j) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;              a(i,j) = one</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;              a(i,j) = zero</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="keywordflow">         END DO</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      <span class="keywordflow">DO</span> i=1,ndi</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;         <span class="keywordflow">DO</span> j=1,ndi</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;          <span class="keywordflow">DO</span> k=1,ndi</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;             <span class="keywordflow">DO</span> l=1,ndi</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;              aa(i,j,k,l)=a(i,k)*a(j,l)</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;              aas(i,j,k,l)=(one/two)*(a(i,k)*a(j,l)+a(i,l)*a(j,k))</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="keywordflow">           END DO</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="keywordflow">          END DO</span></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="identity__tensors_8for.html#a03fd2442d72065c8a2c3cfb10467ceb6">onem</a></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="metiso_8for.html#adfb372f50c7b7ab0bbc5abad87205763">metiso</a>(CMISO,CMFIC,PL,PKISO,PKFIC,C,UNIT2,DET,NDI)</div><div class="line"><a name="l01340"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#adfb372f50c7b7ab0bbc5abad87205763"> 1340</a></span>&#160;<span class="comment">C&gt;    ISOCHORIC MATERIAL ELASTICITY TENSOR</span></div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;      <span class="keywordtype">INTEGER</span> NDI,I1,J1,K1,L1</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> UNIT2(ndi,ndi),PL(ndi,ndi,ndi,ndi),</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;     1                 cmiso(ndi,ndi,ndi,ndi),pkiso(ndi,ndi),</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;     2                 cmfic(ndi,ndi,ndi,ndi),pkfic(ndi,ndi),</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;     3                 cisoaux(ndi,ndi,ndi,ndi),</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;     4                 cisoaux1(ndi,ndi,ndi,ndi),c(ndi,ndi),</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;     5                 plt(ndi,ndi,ndi,ndi),cinv(ndi,ndi),</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;     6                 pll(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> TRFIC,XX,YY,ZZ,DET,AUX,AUX1</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      <span class="keyword">CALL </span><a class="code" href="minverse3d_8for.html#a57fcae0e55c917727e5a5e824f445f4e">matinv3d</a>(c,cinv,ndi)</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      cisoaux1=zero</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      cisoaux=zero</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      <span class="keyword">CALL </span><a class="code" href="contraction44_8for.html#ad99a62a07d01f333320f807d2c991a51">contraction44</a>(cisoaux1,pl,cmfic,ndi)</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="comment">C      </span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="comment">C  transpose of lagrangian projection tensor     </span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      <span class="keywordflow">DO</span> i1=1,ndi</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        <span class="keywordflow">DO</span> j1=1,ndi</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;           <span class="keywordflow">DO</span> k1=1,ndi</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;              <span class="keywordflow">DO</span> l1=1,ndi</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                plt(i1,j1,k1,l1)=pl(k1,l1,i1,j1)</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="keywordflow">              END DO</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="keywordflow">         END DO</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;      <span class="keyword">CALL </span><a class="code" href="contraction44_8for.html#ad99a62a07d01f333320f807d2c991a51">contraction44</a>(cisoaux,cisoaux1,plt,ndi)</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      trfic=zero</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      aux=det**(-two/three)</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      aux1=aux**two</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      <span class="keywordflow">DO</span> i1=1,ndi</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;         trfic=trfic+aux*pkfic(i1,i1)*c(i1,i1)</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      <span class="keywordflow">DO</span> i1=1,ndi</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        <span class="keywordflow">DO</span> j1=1,ndi</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;           <span class="keywordflow">DO</span> k1=1,ndi</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;              <span class="keywordflow">DO</span> l1=1,ndi</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                xx=aux1*cisoaux(i1,j1,k1,l1)</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                pll(i1,j1,k1,l1)=(one/two)*(cinv(i1,k1)*cinv(j1,l1)+</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;     1                                      cinv(i1,l1)*cinv(j1,k1))-</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;     2                           (one/three)*cinv(i1,j1)*cinv(k1,l1)</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                yy=trfic*pll(i1,j1,k1,l1)</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                zz=pkiso(i1,j1)*cinv(k1,l1)+cinv(i1,j1)*pkiso(k1,l1)</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                cmiso(i1,j1,k1,l1)=xx+(two/three)*yy-(two/three)*zz</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="keywordflow">              END DO</span></div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="keywordflow">           END DO</span></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="metiso_8for.html#adfb372f50c7b7ab0bbc5abad87205763">metiso</a></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="setiso_8for.html#a684bfc6ac044f6740b76347b3ff89a24">setiso</a>(CISO,CFIC,PE,SISO,SFIC,UNIT2,NDI)</div><div class="line"><a name="l01399"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a684bfc6ac044f6740b76347b3ff89a24"> 1399</a></span>&#160;<span class="comment">C&gt;    ISOCHORIC SPATIAL ELASTICITY TENSOR</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;      <span class="keywordtype">INTEGER</span> NDI,I1,J1,K1,L1</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> UNIT2(ndi,ndi),PE(ndi,ndi,ndi,ndi),</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;     1                 ciso(ndi,ndi,ndi,ndi),siso(ndi,ndi),</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;     2                 cfic(ndi,ndi,ndi,ndi),sfic(ndi,ndi),</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;     3                 cisoaux(ndi,ndi,ndi,ndi),</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;     4                 cisoaux1(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> TRFIC,XX,YY,ZZ</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      cisoaux1=zero</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      cisoaux=zero</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      <span class="keyword">CALL </span><a class="code" href="contraction44_8for.html#ad99a62a07d01f333320f807d2c991a51">contraction44</a>(cisoaux1,pe,cfic,ndi)      </div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      <span class="keyword">CALL </span><a class="code" href="contraction44_8for.html#ad99a62a07d01f333320f807d2c991a51">contraction44</a>(cisoaux,cisoaux1,pe,ndi)</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      trfic=zero</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      <span class="keywordflow">DO</span> i1=1,ndi</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;         trfic=trfic+sfic(i1,i1)</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;      <span class="keywordflow">DO</span> i1=1,ndi</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        <span class="keywordflow">DO</span> j1=1,ndi</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;           <span class="keywordflow">DO</span> k1=1,ndi</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;              <span class="keywordflow">DO</span> l1=1,ndi</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                xx=cisoaux(i1,j1,k1,l1)</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                yy=trfic*pe(i1,j1,k1,l1)</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                zz=siso(i1,j1)*unit2(k1,l1)+unit2(i1,j1)*siso(k1,l1)</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="comment">C                </span></div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                ciso(i1,j1,k1,l1)=xx+(two/three)*yy-(two/three)*zz</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="keywordflow">              END DO</span></div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="keywordflow">           END DO</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="setiso_8for.html#a684bfc6ac044f6740b76347b3ff89a24">setiso</a></div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="push2_8for.html#acb1875b4820cb25bf65814b33f47cf99">push2</a>(SIG,PK,F,DET,NDI)</div><div class="line"><a name="l01439"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#acb1875b4820cb25bf65814b33f47cf99"> 1439</a></span>&#160;<span class="comment">C&gt;        PIOLA TRANSFORMATION</span></div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment">C&gt;      INPUT:</span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment">C&gt;       PK - 2ND PIOLA KIRCHOOF STRESS TENSOR</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment">C&gt;       F - DEFORMATION GRADIENT</span></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="comment">C&gt;       DET - DEFORMATION DETERMINANT</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="comment">C&gt;      OUTPUT:</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="comment">C&gt;       SIG - CAUCHY STRESS TENSOR</span></div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;       <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;       include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;       <span class="keywordtype">INTEGER</span> I1,J1,II1,JJ1,NDI</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> PK(ndi,ndi),F(ndi,ndi)</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> SIG(ndi,ndi)</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;       <span class="keywordtype">DOUBLE PRECISION</span> AUX,DET</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;       <span class="keywordflow">DO</span> i1=1,ndi</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;        <span class="keywordflow">DO</span> j1=1,ndi</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;          aux=zero</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;         <span class="keywordflow">DO</span> ii1=1,ndi</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;          <span class="keywordflow">DO</span> jj1=1,ndi</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;            aux=aux+(det**(-one))*f(i1,ii1)*f(j1,jj1)*pk(ii1,jj1)</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="keywordflow">         END DO</span></div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;           sig(i1,j1)=aux</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="keywordflow">       END DO</span></div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;       <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="push2_8for.html#acb1875b4820cb25bf65814b33f47cf99">push2</a></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="deformation_8for.html#ab2dc1e77c2638cdfcf26b771842db2b7">deformation</a>(F,C,B,NDI)</div><div class="line"><a name="l01469"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#ab2dc1e77c2638cdfcf26b771842db2b7"> 1469</a></span>&#160;<span class="comment">C&gt;     RIGHT AND LEFT CAUCHY-GREEN DEFORMATION TENSORS</span></div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;      <span class="keywordtype">INTEGER</span> NDI</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> F(ndi,ndi),C(ndi,ndi),B(ndi,ndi) </div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="comment">C     RIGHT CAUCHY-GREEN DEFORMATION TENSOR</span></div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;      c=matmul(transpose(f),f)</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="comment">C     LEFT CAUCHY-GREEN DEFORMATION TENSOR</span></div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      b=matmul(f,transpose(f))</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="deformation_8for.html#ab2dc1e77c2638cdfcf26b771842db2b7">deformation</a></div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="fslip_8for.html#ad2335e079bf9907ca25a55c19e01c333">fslip</a>(F,FBAR,DET,NDI)</div><div class="line"><a name="l01482"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#ad2335e079bf9907ca25a55c19e01c333"> 1482</a></span>&#160;<span class="comment">C&gt;     DISTORTION GRADIENT</span></div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;      <span class="keywordtype">INTEGER</span> NDI,I1,J1</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> F(ndi,ndi),FBAR(ndi,ndi)</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> DET,SCALE1</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="comment">C     </span></div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="comment">C     JACOBIAN DETERMINANT</span></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;      det = f(1,1) * f(2,2) * f(3,3)</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;     1    - f(1,2) * f(2,1) * f(3,3)</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;      <span class="keywordflow">IF</span> (ndi .EQ. 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;          det = det + f(1,2) * f(2,3) * f(3,1)</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;     1              + f(1,3) * f(3,2) * f(2,1)</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;     2              - f(1,3) * f(3,1) * f(2,2)</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;     3              - f(2,3) * f(3,2) * f(1,1)</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="keywordflow">      END IF</span> </div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      scale1=det**(-one /three)</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;<span class="comment">C      </span></div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      <span class="keywordflow">DO</span> i1=1,ndi</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        <span class="keywordflow">DO</span> j1=1,ndi</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;          fbar(i1,j1)=scale1*f(i1,j1)</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      <span class="keywordflow">RETURN</span>      </div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="fslip_8for.html#ad2335e079bf9907ca25a55c19e01c333">fslip</a></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="cmatanisomatfic_8for.html#ac0fc260602607e54e92d94a58fb2594d">cmatanisomatfic</a>(CMANISOMATFIC,M0,DANISO,UNIT2,DET,NDI)</div><div class="line"><a name="l01512"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#ac0fc260602607e54e92d94a58fb2594d"> 1512</a></span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment">C&gt;    ANISOTROPIC MATRIX: MATERIAL &#39;FICTICIOUS&#39; ELASTICITY TENSOR</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;      <span class="keywordtype">INTEGER</span> NDI,I,J,K,L</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> CMANISOMATFIC(ndi,ndi,ndi,ndi),UNIT2(ndi,ndi),</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;     1                 m0(ndi,ndi),daniso(3),det</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> CINV4(ndi,ndi,ndi,ndi),CINV14(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> D2UDI4,D2UDI1DI4</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> IMM(ndi,ndi,ndi,ndi),MMI(ndi,ndi,ndi,ndi),</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;     1                 mm0(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="comment">C-----------------------------------------------------------------------------</span></div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;      <span class="comment">!2ND DERIVATIVE OF SSEANISO IN ORDER TO I4</span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      d2udi4=daniso(2)</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;      <span class="comment">!2ND DERIVATIVE OF SSEANISO IN ORDER TO I1 AND I4</span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      d2udi1di4=daniso(3)</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      <span class="keyword">CALL </span><a class="code" href="tensorprod22_8for.html#ade4458c8350bdd937ff4405df54f6328">tensorprod2</a>(m0,m0,mm0,ndi)</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      <span class="keyword">CALL </span><a class="code" href="tensorprod22_8for.html#ade4458c8350bdd937ff4405df54f6328">tensorprod2</a>(unit2,m0,imm,ndi)</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      <span class="keyword">CALL </span><a class="code" href="tensorprod22_8for.html#ade4458c8350bdd937ff4405df54f6328">tensorprod2</a>(m0,unit2,mmi,ndi)</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;      <span class="keywordflow">DO</span> i=1,ndi</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;       <span class="keywordflow">DO</span> j=1,ndi</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;         <span class="keywordflow">DO</span> k=1,ndi</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;          <span class="keywordflow">DO</span> l=1,ndi</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;          cinv4(i,j,k,l)=d2udi4*mm0(i,j,k,l)</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;          cinv14(i,j,k,l)=d2udi1di4*(imm(i,j,k,l)+mmi(i,j,k,l))</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;          cmanisomatfic(i,j,k,l)=four*(cinv4(i,j,k,l)+cinv14(i,j,k,l))</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="keywordflow">          END DO</span></div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="keywordflow">         END DO</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="keywordflow">       END DO</span></div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="cmatanisomatfic_8for.html#ac0fc260602607e54e92d94a58fb2594d">cmatanisomatfic</a></div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="sdvwrite_8for.html#a10cc1dd858c5a3789ac6e12fcba396a0">sdvwrite</a>(DET,LAMBDA,STATEV)</div><div class="line"><a name="l01550"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a10cc1dd858c5a3789ac6e12fcba396a0"> 1550</a></span>&#160;<span class="comment">C&gt;    VISCOUS DISSIPATION: WRITE STATE VARS</span></div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> STATEV(nsdv),DET,LAMBDA</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="comment">C        write your sdvs here. they should be allocated </span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;<span class="comment">C                after the viscous terms (check hvwrite)</span></div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;       statev(1)=det</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;       statev(2)=lambda </div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="sdvwrite_8for.html#a10cc1dd858c5a3789ac6e12fcba396a0">sdvwrite</a></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="resetdfgr_8for.html#adc9a851f1c601bb4ea53606642760047">resetdfgrd</a>(DFGRD,NDI)</div><div class="line"><a name="l01564"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#adc9a851f1c601bb4ea53606642760047"> 1564</a></span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;      </div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;      <span class="keywordtype">INTEGER</span> NDI</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> DFGRD(ndi,ndi)</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        dfgrd(1,1)=  one</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        dfgrd(1,2)=  zero</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        dfgrd(1,3)=  zero</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        dfgrd(2,1)=  zero</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        dfgrd(2,2)=  one</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        dfgrd(2,3)=  zero</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        dfgrd(3,1)=  zero</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        dfgrd(3,2)=  zero</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        dfgrd(3,3)=  one</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="resetdfgr_8for.html#adc9a851f1c601bb4ea53606642760047">resetdfgrd</a></div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="fibdir_8for.html#ad4f956d16c26f610a5b52ef9c9da3cf0">fibdir</a>(FIB,ST0,ST,NE,NOEL,NDI,VORIF,VD,DISTGR,DFGRD1)</div><div class="line"><a name="l01583"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#ad4f956d16c26f610a5b52ef9c9da3cf0"> 1583</a></span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      <span class="keywordtype">INTEGER</span> NDI, NE, NOEL,INOEL,I,J,I1,J1</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> SUM1, DFGRD1(3,3), DNORM</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> VORIF(3),ST(3,3),VD(3),ST0(3,3),DISTGR(3,3)</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> FIB(ne,4)</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;        inoel=0</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;        i=0</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        <span class="keywordflow">DO</span> i=1,ne</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="comment">C               ELEMENT IDENTIFICATION</span></div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;            <span class="keywordflow">IF</span>(noel.EQ.int(fib(i,1))) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                inoel=i</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="keywordflow">            ENDIF</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="keywordflow">        ENDDO</span></div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="comment">C     FIB - FIBER ORIENTATION</span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;             dnorm=dsqrt(fib(inoel,2)*fib(inoel,2)+</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;     1                   fib(inoel,3)*fib(inoel,3)+</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;     2                   fib(inoel,4)*fib(inoel,4))</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="comment">C       UNDERFORMED FIBER ORIENTATION TENSOR</span></div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;        <span class="keywordflow">DO</span> i1=1,ndi</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;        j1=i1+1</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;<span class="comment">C       FIBER ORIENTATION NORMALIZED VECTOR - FAMILY 1</span></div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        vorif(i1)=fib(inoel,j1)/dnorm</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;      <span class="keywordflow">DO</span> i=1,ndi</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;         sum1=zero</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;         <span class="keywordflow">DO</span> j=1,ndi</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;          sum1=sum1+dfgrd1(i,j)*vorif(j)</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="keywordflow">         ENDDO</span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="comment">C     FIBER DIRECTIONS IN THE DEFORMED CONFIGURATION</span></div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="comment">C               -FAMILY 1</span></div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;         vd(i)=sum1</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<span class="keywordflow">      ENDDO</span></div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;      dnorm=dsqrt(vd(1)*vd(1)+</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;     1             vd(2)*vd(2)+</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;     2             vd(3)*vd(3))</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="comment">C           COSINE OF THE ANGLE BETWEEN FIBERS</span></div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;<span class="comment">C--------------------------------------------------------------------------</span></div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;      <span class="keywordflow">DO</span> i=1,ndi</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;       <span class="keywordflow">DO</span> j=1,ndi</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;<span class="comment">C       STRUCTURAL TENSOR - FAMILY 1</span></div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;       st0(i,j)=vorif(i)*vorif(j)</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="keywordflow">       END DO</span></div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="comment">C       STRUCTURE TENSOR IN THE DEFORMED CONFIGURATION - FAMILY 1</span></div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;      st=matmul(st0,transpose(distgr))</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;      st=matmul(distgr,st)</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="fibdir_8for.html#ad4f956d16c26f610a5b52ef9c9da3cf0">fibdir</a></div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="index_8for.html#a08f48dba99892c8df390efd4490d66fa">indexx</a>(STRESS,DDSDDE,SIG,TNG,NTENS,NDI)</div><div class="line"><a name="l01646"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a08f48dba99892c8df390efd4490d66fa"> 1646</a></span>&#160;<span class="comment">C&gt;    INDEXATION: FULL SIMMETRY  IN STRESSES AND ELASTICITY TENSORS</span></div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;      <span class="keywordtype">INTEGER</span> II1(6),II2(6),NTENS,NDI,I1,J1</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> STRESS(ntens),DDSDDE(ntens,ntens)</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> SIG(ndi,ndi),TNG(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> PP1,PP2</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;      ii1(1)=1</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;      ii1(2)=2</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;      ii1(3)=3</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;      ii1(4)=1</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;      ii1(5)=1</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;      ii1(6)=2</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;      ii2(1)=1</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      ii2(2)=2</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;      ii2(3)=3</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;      ii2(4)=2</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;      ii2(5)=3</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;      ii2(6)=3</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;      <span class="keywordflow">DO</span> i1=1,ntens</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;<span class="comment">C       STRESS VECTOR</span></div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;         stress(i1)=sig(ii1(i1),ii2(i1))</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;         <span class="keywordflow">DO</span> j1=1,ntens</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<span class="comment">C       DDSDDE - FULLY SIMMETRY IMPOSED</span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;            pp1=tng(ii1(i1),ii2(i1),ii1(j1),ii2(j1))</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;            pp2=tng(ii1(i1),ii2(i1),ii2(j1),ii1(j1))</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;            ddsdde(i1,j1)=(one/two)*(pp1+pp2)</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="keywordflow">         END DO</span></div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="index_8for.html#a08f48dba99892c8df390efd4490d66fa">indexx</a></div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="rotation_8for.html#a75b4b6ad5b953d7b49af0362930cac42">rotation</a>(F,R,U,NDI)</div><div class="line"><a name="l01684"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a75b4b6ad5b953d7b49af0362930cac42"> 1684</a></span>&#160;<span class="comment">C&gt;    COMPUTES ROTATION TENSOR</span></div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;      <span class="keywordtype">INTEGER</span> NDI</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> F(ndi,ndi),R(ndi,ndi),U(ndi,ndi),UINV(ndi,ndi)</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;      <span class="keyword">CALL </span><a class="code" href="minverse3d_8for.html#a57fcae0e55c917727e5a5e824f445f4e">matinv3d</a>(u,uinv,ndi)</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;      r = matmul(f,uinv)</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="rotation_8for.html#a75b4b6ad5b953d7b49af0362930cac42">rotation</a></div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="cmatisomatfic_8for.html#aefae10fd7e02adb2b87c090a42bb1baa">cmatisomatfic</a>(CMISOMATFIC,CBAR,CBARI1,CBARI2,</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;     1                          diso,unit2,unit4,det,ndi)</div><div class="line"><a name="l01698"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#aefae10fd7e02adb2b87c090a42bb1baa"> 1698</a></span>&#160;<span class="comment">C&gt;    ISOTROPIC MATRIX: MATERIAL &#39;FICTICIOUS&#39; ELASTICITY TENSOR</span></div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;      <span class="keywordtype">INTEGER</span> NDI,I1,J1,K1,L1</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> CMISOMATFIC(ndi,ndi,ndi,ndi),UNIT2(ndi,ndi),</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;     1                 cbar(ndi,ndi),diso(5),</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;     2                 unit4(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> CBARI1,CBARI2</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> DUDI1,DUDI2,D2UD2I1,D2UD2I2,D2UDI1I2</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> AUX,AUX1,AUX2,AUX3,AUX4,DET</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> UIJ,UKL,CIJ,CKL   </div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      dudi1=diso(1)</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;      dudi2=diso(2)</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;      d2ud2i1=diso(3)</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;      d2ud2i2=diso(4)</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;      d2udi1i2=diso(5)</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      aux1=four*(d2ud2i1+two*cbari1*d2udi1i2+</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;     1           dudi2+cbari1*cbari1*d2ud2i2)</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      aux2=-four*(d2udi1i2+cbari1*d2ud2i2)</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;      aux3=four*d2ud2i2</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;      aux4=-four*dudi2</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;      <span class="keywordflow">DO</span> i1=1,ndi</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        <span class="keywordflow">DO</span> j1=1,ndi</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;           <span class="keywordflow">DO</span> k1=1,ndi</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;              <span class="keywordflow">DO</span> l1=1,ndi</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                     uij=unit2(i1,j1)</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                     ukl=unit2(k1,l1)</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                     cij=cbar(i1,j1)</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                     ckl=cbar(k1,l1)</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                     aux=aux1*uij*ukl+</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;     1                   aux2*(uij*ckl+cij*ukl)+aux3*cij*ckl+</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;     3                   aux4*unit4(i1,j1,k1,l1)</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                     cmisomatfic(i1,j1,k1,l1)=aux        </div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="keywordflow">              END DO</span></div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;<span class="keywordflow">           END DO</span></div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="cmatisomatfic_8for.html#aefae10fd7e02adb2b87c090a42bb1baa">cmatisomatfic</a></div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="proj__lagrangian_8for.html#ad4a855453319c895aa447c6517605e4a">projlag</a>(C,AA,PL,NDI)</div><div class="line"><a name="l01743"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#ad4a855453319c895aa447c6517605e4a"> 1743</a></span>&#160;<span class="comment">C&gt;    LAGRANGIAN PROJECTION TENSOR</span></div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;<span class="comment">C      INPUTS:</span></div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="comment">C          IDENTITY TENSORS - A, AA</span></div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;<span class="comment">C          ISOCHORIC LEFT CAUCHY GREEN TENSOR - C</span></div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="comment">C          INVERSE OF C - CINV</span></div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="comment">C      OUTPUTS:</span></div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="comment">C          4TH ORDER SYMMETRIC LAGRANGIAN PROJECTION TENSOR - PL</span></div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;      <span class="keywordtype">INTEGER</span> I,J,K,L,NDI</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> CINV(ndi,ndi),AA(ndi,ndi,ndi,ndi),</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;     1                 pl(ndi,ndi,ndi,ndi),c(ndi,ndi)</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;      <span class="keyword">CALL </span><a class="code" href="minverse3d_8for.html#a57fcae0e55c917727e5a5e824f445f4e">matinv3d</a>(c,cinv,ndi)</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;      <span class="keywordflow">DO</span> i=1,ndi</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;         <span class="keywordflow">DO</span> j=1,ndi</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;          <span class="keywordflow">DO</span> k=1,ndi</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;             <span class="keywordflow">DO</span> l=1,ndi</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;              pl(i,j,k,l)=aa(i,j,k,l)-(one/three)*(cinv(i,j)*c(k,l))</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="keywordflow">           END DO</span></div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;<span class="keywordflow">          END DO</span></div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="proj__lagrangian_8for.html#ad4a855453319c895aa447c6517605e4a">projlag</a></div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="cisomatfic_8for.html#a9bae2c893581a5ef032c8e109eb1ea0c">csisomatfic</a>(CISOMATFIC,CMISOMATFIC,DISTGR,DET,NDI)</div><div class="line"><a name="l01774"></a><span class="lineno"><a class="line" href="test__in__abaqus_2umat__general_8for.html#a9bae2c893581a5ef032c8e109eb1ea0c"> 1774</a></span>&#160;<span class="comment">C&gt;    ISOTROPIC MATRIX: SPATIAL &#39;FICTICIOUS&#39; ELASTICITY TENSOR</span></div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;      include <span class="stringliteral">&#39;PARAM_UMAT.INC&#39;</span></div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      <span class="keywordtype">INTEGER</span> NDI</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> CMISOMATFIC(ndi,ndi),DISTGR(ndi,ndi),</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;     1                 cisomatfic(ndi,ndi,ndi,ndi)</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> DET  </div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;      <span class="keyword">CALL </span><a class="code" href="push4_8for.html#a8eaa214e9279f4ea3fa90ff3c0e85f31">push4</a>(cisomatfic,cmisomatfic,distgr,det,ndi)</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="cisomatfic_8for.html#a9bae2c893581a5ef032c8e109eb1ea0c">csisomatfic</a></div><div class="ttc" id="pull4_8for_html_a815133b3937aaf329a48c13107b973c4"><div class="ttname"><a href="pull4_8for.html#a815133b3937aaf329a48c13107b973c4">pull4</a></div><div class="ttdeci">subroutine pull4(MAT, SPATIAL, FINV, DET, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="pull4_8for_source.html#l00002">pull4.for:2</a></div></div>
<div class="ttc" id="uexternaldb_8for_html_af82fa72f6d0f9acdbf18f2de5016962b"><div class="ttname"><a href="uexternaldb_8for.html#af82fa72f6d0f9acdbf18f2de5016962b">uexternaldb</a></div><div class="ttdeci">subroutine uexternaldb(LOP, LRESTART, TIME, DTIME, KSTEP, KINC)</div><div class="ttdef"><b>Definition:</b> <a href="uexternaldb_8for_source.html#l00002">uexternaldb.for:2</a></div></div>
<div class="ttc" id="sdvread_8for_html_aac71ab9ddec68cb5a041a5bfe955190f"><div class="ttname"><a href="sdvread_8for.html#aac71ab9ddec68cb5a041a5bfe955190f">sdvread</a></div><div class="ttdeci">subroutine sdvread(STATEV)</div><div class="ttdef"><b>Definition:</b> <a href="sdvread_8for_source.html#l00002">sdvread.for:2</a></div></div>
<div class="ttc" id="anisomat_8for_html_afa561bbd538fbcb594d34258412f5db5"><div class="ttname"><a href="anisomat_8for.html#afa561bbd538fbcb594d34258412f5db5">anisomat</a></div><div class="ttdeci">subroutine anisomat(SSEANISO, DANISO, DISO, K1, K2, KDISP, I4, I1)</div><div class="ttdef"><b>Definition:</b> <a href="anisomat_8for_source.html#l00002">anisomat.for:2</a></div></div>
<div class="ttc" id="initialize_8for_html_afb6af130004528dffe465dd6b0c53894"><div class="ttname"><a href="initialize_8for.html#afb6af130004528dffe465dd6b0c53894">initialize</a></div><div class="ttdeci">subroutine initialize(STATEV)</div><div class="ttdef"><b>Definition:</b> <a href="initialize_8for_source.html#l00002">initialize.for:2</a></div></div>
<div class="ttc" id="contraction44_8for_html_ad99a62a07d01f333320f807d2c991a51"><div class="ttname"><a href="contraction44_8for.html#ad99a62a07d01f333320f807d2c991a51">contraction44</a></div><div class="ttdeci">subroutine contraction44(S, LT, RT, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="contraction44_8for_source.html#l00002">contraction44.for:2</a></div></div>
<div class="ttc" id="deformation_8for_html_ab2dc1e77c2638cdfcf26b771842db2b7"><div class="ttname"><a href="deformation_8for.html#ab2dc1e77c2638cdfcf26b771842db2b7">deformation</a></div><div class="ttdeci">subroutine deformation(F, C, B, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="deformation_8for_source.html#l00002">deformation.for:2</a></div></div>
<div class="ttc" id="push2_8for_html_acb1875b4820cb25bf65814b33f47cf99"><div class="ttname"><a href="push2_8for.html#acb1875b4820cb25bf65814b33f47cf99">push2</a></div><div class="ttdeci">subroutine push2(SIG, PK, F, DET, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="push2_8for_source.html#l00002">push2.for:2</a></div></div>
<div class="ttc" id="sdvwrite_8for_html_a10cc1dd858c5a3789ac6e12fcba396a0"><div class="ttname"><a href="sdvwrite_8for.html#a10cc1dd858c5a3789ac6e12fcba396a0">sdvwrite</a></div><div class="ttdeci">subroutine sdvwrite(DET, LAMBDA, STATEV)</div><div class="ttdef"><b>Definition:</b> <a href="sdvwrite_8for_source.html#l00002">sdvwrite.for:2</a></div></div>
<div class="ttc" id="setiso_8for_html_a684bfc6ac044f6740b76347b3ff89a24"><div class="ttname"><a href="setiso_8for.html#a684bfc6ac044f6740b76347b3ff89a24">setiso</a></div><div class="ttdeci">subroutine setiso(CISO, CFIC, PE, SISO, SFIC, UNIT2, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="setiso_8for_source.html#l00002">setiso.for:2</a></div></div>
<div class="ttc" id="cmatanisomatfic_8for_html_ac0fc260602607e54e92d94a58fb2594d"><div class="ttname"><a href="cmatanisomatfic_8for.html#ac0fc260602607e54e92d94a58fb2594d">cmatanisomatfic</a></div><div class="ttdeci">subroutine cmatanisomatfic(CMANISOMATFIC, M0, DANISO, UNIT2, DET, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="cmatanisomatfic_8for_source.html#l00002">cmatanisomatfic.for:2</a></div></div>
<div class="ttc" id="spectral_8for_html_af30a892ec55877718024cfef2cee100e"><div class="ttname"><a href="spectral_8for.html#af30a892ec55877718024cfef2cee100e">jacobi</a></div><div class="ttdeci">subroutine jacobi(A, N, NP, D, V, NROT)</div><div class="ttdef"><b>Definition:</b> <a href="spectral_8for_source.html#l00028">spectral.for:28</a></div></div>
<div class="ttc" id="stretch_8for_html_a35c9d800d4cdf46135fd6fe61edb5fa2"><div class="ttname"><a href="stretch_8for.html#a35c9d800d4cdf46135fd6fe61edb5fa2">stretch</a></div><div class="ttdeci">subroutine stretch(C, B, U, V, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="stretch_8for_source.html#l00002">stretch.for:2</a></div></div>
<div class="ttc" id="minverse3d_8for_html_a57fcae0e55c917727e5a5e824f445f4e"><div class="ttname"><a href="minverse3d_8for.html#a57fcae0e55c917727e5a5e824f445f4e">matinv3d</a></div><div class="ttdeci">subroutine matinv3d(A, A_INV, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="minverse3d_8for_source.html#l00002">minverse3d.for:2</a></div></div>
<div class="ttc" id="identity__tensors_8for_html_a03fd2442d72065c8a2c3cfb10467ceb6"><div class="ttname"><a href="identity__tensors_8for.html#a03fd2442d72065c8a2c3cfb10467ceb6">onem</a></div><div class="ttdeci">subroutine onem(A, AA, AAS, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="identity__tensors_8for_source.html#l00002">identity_tensors.for:2</a></div></div>
<div class="ttc" id="fibdir_8for_html_ad4f956d16c26f610a5b52ef9c9da3cf0"><div class="ttname"><a href="fibdir_8for.html#ad4f956d16c26f610a5b52ef9c9da3cf0">fibdir</a></div><div class="ttdeci">subroutine fibdir(FIB, ST0, ST, NE, NOEL, NDI, VORIF, VD, DISTGR, DFGRD1)</div><div class="ttdef"><b>Definition:</b> <a href="fibdir_8for_source.html#l00002">fibdir.for:2</a></div></div>
<div class="ttc" id="push4_8for_html_a8eaa214e9279f4ea3fa90ff3c0e85f31"><div class="ttname"><a href="push4_8for.html#a8eaa214e9279f4ea3fa90ff3c0e85f31">push4</a></div><div class="ttdeci">subroutine push4(SPATIAL, MAT, F, DET, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="push4_8for_source.html#l00002">push4.for:2</a></div></div>
<div class="ttc" id="metvol_8for_html_af4851b40ff9da9c702d8d02257ee2d41"><div class="ttname"><a href="metvol_8for.html#af4851b40ff9da9c702d8d02257ee2d41">metvol</a></div><div class="ttdeci">subroutine metvol(CVOL, C, PV, PPV, DET, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="metvol_8for_source.html#l00002">metvol.for:2</a></div></div>
<div class="ttc" id="__umat_8for_html_ade59a72c9e55c27de31535430ff6916e"><div class="ttname"><a href="__umat_8for.html#ade59a72c9e55c27de31535430ff6916e">umat</a></div><div class="ttdeci">subroutine umat(STRESS, STATEV, DDSDDE, SSE, SPD, SCD, RPL, DDSDDT, DRPLDE, DRPLDT, STRAN, DSTRAN, TIME, DTIME, TEMP, DTEMP, PREDEF, DPRED, CMNAME, NDI, NSHR, NTENS, NSTATEV, PROPS, NPROPS, COORDS, DROT, PNEWDT, CELENT, DFGRD0, DFGRD1, NOEL, NPT, LAYER, KSPT, KSTEP, KINC)</div><div class="ttdoc"> Record of revisions: | Date Programmer Description of change | ==== ========== =====================...</div><div class="ttdef"><b>Definition:</b> <a href="__umat_8for_source.html#l00031">_umat.for:31</a></div></div>
<div class="ttc" id="cisomatfic_8for_html_a9bae2c893581a5ef032c8e109eb1ea0c"><div class="ttname"><a href="cisomatfic_8for.html#a9bae2c893581a5ef032c8e109eb1ea0c">csisomatfic</a></div><div class="ttdeci">subroutine csisomatfic(CISOMATFIC, CMISOMATFIC, DISTGR, DET, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="cisomatfic_8for_source.html#l00002">cisomatfic.for:2</a></div></div>
<div class="ttc" id="sigisomatfic_8for_html_a5dc6369258e0cde9daee2a9ccec7972a"><div class="ttname"><a href="sigisomatfic_8for.html#a5dc6369258e0cde9daee2a9ccec7972a">sigisomatfic</a></div><div class="ttdeci">subroutine sigisomatfic(SFIC, PKFIC, F, DET, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="sigisomatfic_8for_source.html#l00002">sigisomatfic.for:2</a></div></div>
<div class="ttc" id="invariants_8for_html_a2c2c5ef734d284a0f4a38320eb18e267"><div class="ttname"><a href="invariants_8for.html#a2c2c5ef734d284a0f4a38320eb18e267">invariants</a></div><div class="ttdeci">subroutine invariants(A, INV1, INV2, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="invariants_8for_source.html#l00002">invariants.for:2</a></div></div>
<div class="ttc" id="sigvol_8for_html_a8d289ee29f4702d72fb71cb2d89c6f12"><div class="ttname"><a href="sigvol_8for.html#a8d289ee29f4702d72fb71cb2d89c6f12">sigvol</a></div><div class="ttdeci">subroutine sigvol(SVOL, PV, UNIT2, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="sigvol_8for_source.html#l00002">sigvol.for:2</a></div></div>
<div class="ttc" id="proj__eulerian_8for_html_a6c4553cadb8482a8d0484d6d8ff5da18"><div class="ttname"><a href="proj__eulerian_8for.html#a6c4553cadb8482a8d0484d6d8ff5da18">projeul</a></div><div class="ttdeci">subroutine projeul(A, AA, PE, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="proj__eulerian_8for_source.html#l00002">proj_eulerian.for:2</a></div></div>
<div class="ttc" id="_g_e_t_o_u_t_d_i_r_8for_html_a76d92cb7acf0fa97519e0cc1c71cf219"><div class="ttname"><a href="_g_e_t_o_u_t_d_i_r_8for.html#a76d92cb7acf0fa97519e0cc1c71cf219">getoutdir</a></div><div class="ttdeci">subroutine getoutdir(OUTDIR, LENOUTDIR)</div><div class="ttdef"><b>Definition:</b> <a href="_g_e_t_o_u_t_d_i_r_8for_source.html#l00002">GETOUTDIR.for:2</a></div></div>
<div class="ttc" id="contraction42_8for_html_aad71a324137b3d597992a6ba4386bc1c"><div class="ttname"><a href="contraction42_8for.html#aad71a324137b3d597992a6ba4386bc1c">contraction42</a></div><div class="ttdeci">subroutine contraction42(S, LT, RT, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="contraction42_8for_source.html#l00002">contraction42.for:2</a></div></div>
<div class="ttc" id="index_8for_html_a08f48dba99892c8df390efd4490d66fa"><div class="ttname"><a href="index_8for.html#a08f48dba99892c8df390efd4490d66fa">indexx</a></div><div class="ttdeci">subroutine indexx(STRESS, DDSDDE, SIG, TNG, NTENS, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="index_8for_source.html#l00002">index.for:2</a></div></div>
<div class="ttc" id="pk2iso_8for_html_a525f2295f9830b95a6b5ce67d04ea1eb"><div class="ttname"><a href="pk2iso_8for.html#a525f2295f9830b95a6b5ce67d04ea1eb">pk2iso</a></div><div class="ttdeci">subroutine pk2iso(PKISO, PKFIC, PL, DET, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="pk2iso_8for_source.html#l00002">pk2iso.for:2</a></div></div>
<div class="ttc" id="fslip_8for_html_ad2335e079bf9907ca25a55c19e01c333"><div class="ttname"><a href="fslip_8for.html#ad2335e079bf9907ca25a55c19e01c333">fslip</a></div><div class="ttdeci">subroutine fslip(F, FBAR, DET, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="fslip_8for_source.html#l00002">fslip.for:2</a></div></div>
<div class="ttc" id="setjr_8for_html_a4501b4a0d0a60316eab4a804e36a3385"><div class="ttname"><a href="setjr_8for.html#a4501b4a0d0a60316eab4a804e36a3385">setjr</a></div><div class="ttdeci">subroutine setjr(CJR, SIGMA, UNIT2, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="setjr_8for_source.html#l00002">setjr.for:2</a></div></div>
<div class="ttc" id="pull2_8for_html_adb120bb864e22163bbc3bff6f3abeba8"><div class="ttname"><a href="pull2_8for.html#adb120bb864e22163bbc3bff6f3abeba8">pull2</a></div><div class="ttdeci">subroutine pull2(PK, SIG, FINV, DET, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="pull2_8for_source.html#l00002">pull2.for:2</a></div></div>
<div class="ttc" id="pinvariants_8for_html_aaaa7b07924c642fe785a9a8dc96e885e"><div class="ttname"><a href="pinvariants_8for.html#aaaa7b07924c642fe785a9a8dc96e885e">pinvariants</a></div><div class="ttdeci">subroutine pinvariants(A, INV4, NDI, ST, LAMBDA, BARLAMBDA, DET)</div><div class="ttdef"><b>Definition:</b> <a href="pinvariants_8for_source.html#l00002">pinvariants.for:2</a></div></div>
<div class="ttc" id="cmatisomatfic_8for_html_aefae10fd7e02adb2b87c090a42bb1baa"><div class="ttname"><a href="cmatisomatfic_8for.html#aefae10fd7e02adb2b87c090a42bb1baa">cmatisomatfic</a></div><div class="ttdeci">subroutine cmatisomatfic(CMISOMATFIC, CBAR, CBARI1, CBARI2, DISO, UNIT2, UNIT4, DET, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="cmatisomatfic_8for_source.html#l00003">cmatisomatfic.for:3</a></div></div>
<div class="ttc" id="isomat_8for_html_a89e735191fd44d7e7535605f29e52600"><div class="ttname"><a href="isomat_8for.html#a89e735191fd44d7e7535605f29e52600">isomat</a></div><div class="ttdeci">subroutine isomat(SSEISO, DISO, C10, C01, CBARI1, CBARI2)</div><div class="ttdef"><b>Definition:</b> <a href="isomat_8for_source.html#l00002">isomat.for:2</a></div></div>
<div class="ttc" id="spectral_8for_html_a801551e9f01a5150209f80d289d6d41c"><div class="ttname"><a href="spectral_8for.html#a801551e9f01a5150209f80d289d6d41c">spectral</a></div><div class="ttdeci">subroutine spectral(A, D, V)</div><div class="ttdef"><b>Definition:</b> <a href="spectral_8for_source.html#l00002">spectral.for:2</a></div></div>
<div class="ttc" id="tensorprod22_8for_html_ade4458c8350bdd937ff4405df54f6328"><div class="ttname"><a href="tensorprod22_8for.html#ade4458c8350bdd937ff4405df54f6328">tensorprod2</a></div><div class="ttdeci">subroutine tensorprod2(A, B, C, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="tensorprod22_8for_source.html#l00002">tensorprod22.for:2</a></div></div>
<div class="ttc" id="spectral_8for_html_a4cefa75528ebe8935b50d575c9042b3c"><div class="ttname"><a href="spectral_8for.html#a4cefa75528ebe8935b50d575c9042b3c">eigsrt</a></div><div class="ttdeci">subroutine eigsrt(D, V, N, NP)</div><div class="ttdef"><b>Definition:</b> <a href="spectral_8for_source.html#l00191">spectral.for:191</a></div></div>
<div class="ttc" id="pk2anisomatfic_8for_html_a73340e181ab9536885f6db31839ba564"><div class="ttname"><a href="pk2anisomatfic_8for.html#a73340e181ab9536885f6db31839ba564">pk2anisomatfic</a></div><div class="ttdeci">subroutine pk2anisomatfic(AFIC, DANISO, CBAR, INV4, ST0, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="pk2anisomatfic_8for_source.html#l00002">pk2anisomatfic.for:2</a></div></div>
<div class="ttc" id="contraction24_8for_html_a1a863241d0a7a2151c797ceaa85e3be4"><div class="ttname"><a href="contraction24_8for.html#a1a863241d0a7a2151c797ceaa85e3be4">contraction24</a></div><div class="ttdeci">subroutine contraction24(S, LT, RT, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="contraction24_8for_source.html#l00002">contraction24.for:2</a></div></div>
<div class="ttc" id="proj__lagrangian_8for_html_ad4a855453319c895aa447c6517605e4a"><div class="ttname"><a href="proj__lagrangian_8for.html#ad4a855453319c895aa447c6517605e4a">projlag</a></div><div class="ttdeci">subroutine projlag(C, AA, PL, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="proj__lagrangian_8for_source.html#l00002">proj_lagrangian.for:2</a></div></div>
<div class="ttc" id="rotation_8for_html_a75b4b6ad5b953d7b49af0362930cac42"><div class="ttname"><a href="rotation_8for.html#a75b4b6ad5b953d7b49af0362930cac42">rotation</a></div><div class="ttdeci">subroutine rotation(F, R, U, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="rotation_8for_source.html#l00002">rotation.for:2</a></div></div>
<div class="ttc" id="metiso_8for_html_adfb372f50c7b7ab0bbc5abad87205763"><div class="ttname"><a href="metiso_8for.html#adfb372f50c7b7ab0bbc5abad87205763">metiso</a></div><div class="ttdeci">subroutine metiso(CMISO, CMFIC, PL, PKISO, PKFIC, C, UNIT2, DET, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="metiso_8for_source.html#l00002">metiso.for:2</a></div></div>
<div class="ttc" id="resetdfgr_8for_html_adc9a851f1c601bb4ea53606642760047"><div class="ttname"><a href="resetdfgr_8for.html#adc9a851f1c601bb4ea53606642760047">resetdfgrd</a></div><div class="ttdeci">subroutine resetdfgrd(DFGRD, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="resetdfgr_8for_source.html#l00002">resetdfgr.for:2</a></div></div>
<div class="ttc" id="vol_8for_html_abb3cf83c99202d92dfb8df710243dc63"><div class="ttname"><a href="vol_8for.html#abb3cf83c99202d92dfb8df710243dc63">vol</a></div><div class="ttdeci">subroutine vol(SSEV, PV, PPV, K, DET)</div><div class="ttdef"><b>Definition:</b> <a href="vol_8for_source.html#l00002">vol.for:2</a></div></div>
<div class="ttc" id="pk2vol_8for_html_ac9029238abb007c001f636e497ee0ac7"><div class="ttname"><a href="pk2vol_8for.html#ac9029238abb007c001f636e497ee0ac7">pk2vol</a></div><div class="ttdeci">subroutine pk2vol(PKVOL, PV, C, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="pk2vol_8for_source.html#l00002">pk2vol.for:2</a></div></div>
<div class="ttc" id="pk2isomatfic_8for_html_ade33b1396cbfc5dbb036ee5f6048e9a6"><div class="ttname"><a href="pk2isomatfic_8for.html#ade33b1396cbfc5dbb036ee5f6048e9a6">pk2isomatfic</a></div><div class="ttdeci">subroutine pk2isomatfic(FIC, DISO, CBAR, CBARI1, UNIT2, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="pk2isomatfic_8for_source.html#l00002">pk2isomatfic.for:2</a></div></div>
<div class="ttc" id="sigiso_8for_html_a922e87c5383e6f4d45517c30608b0bda"><div class="ttname"><a href="sigiso_8for.html#a922e87c5383e6f4d45517c30608b0bda">sigiso</a></div><div class="ttdeci">subroutine sigiso(SISO, SFIC, PE, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="sigiso_8for_source.html#l00002">sigiso.for:2</a></div></div>
<div class="ttc" id="setvol_8for_html_a85643b95cd69b75883847752822f61f4"><div class="ttname"><a href="setvol_8for.html#a85643b95cd69b75883847752822f61f4">setvol</a></div><div class="ttdeci">subroutine setvol(CVOL, PV, PPV, UNIT2, UNIT4S, NDI)</div><div class="ttdef"><b>Definition:</b> <a href="setvol_8for_source.html#l00002">setvol.for:2</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
